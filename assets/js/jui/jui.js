/*!
 * artTemplate - Template Engine
 * https://github.com/aui/artTemplate
 * Released under the MIT, BSD, and GPL Licenses
 */

!function(){function e(e){return e.replace(y,"").replace(b,",").replace(C,"").replace(_,"").replace($,"").split(x)}function t(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function i(i,s){function n(e){return c+=e.split(/\n/).length-1,d&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=j[1]+t(e)+j[2]+"\n"),e}function a(t){var i=c;if(u?t=u(t,s):o&&(t=t.replace(/\n/g,function(){return"$line="+ ++c+";"})),0===t.indexOf("=")){var n=p&&!/^=[=#]/.test(t);if(t=t.replace(/^=[=#]?|[\s;]*$/g,""),n){var a=t.replace(/\s*\([^\)]+\)/,"");h[a]||/^(include|print)$/.test(a)||(t="$escape("+t+")")}else t="$string("+t+")";t=j[1]+t+j[2]}return o&&(t="$line="+i+";"+t),v(e(t),function(e){if(e&&!f[e]){var t;t="print"===e?b:"include"===e?C:h[e]?"$utils."+e:m[e]?"$helpers."+e:"$data."+e,_+=e+"="+t+",",f[e]=!0}}),t+"\n"}var o=s.debug,l=s.openTag,r=s.closeTag,u=s.parser,d=s.compress,p=s.escape,c=1,f={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},g="".trim,j=g?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],y=g?"$out+=text;return $out;":"$out.push(text);",b="function(){var text=''.concat.apply('',arguments);"+y+"}",C="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+y+"}",_="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(o?"$line=0,":""),$=j[0],x="return new String("+j[3]+");";v(i.split(l),function(e){e=e.split(r);var t=e[0],i=e[1];1===e.length?$+=n(t):($+=a(t),i&&($+=n(i)))});var w=_+$+x;o&&(w="try{"+w+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+t(i)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var F=new Function("$data","$filename",w);return F.prototype=h,F}catch(e){throw e.temp="function anonymous($data,$filename) {"+w+"}",e}}var s=function(e,t){return"string"==typeof t?g(t,{filename:e}):o(e,t)};s.version="3.0.0",s.config=function(e,t){n[e]=t};var n=s.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},a=s.cache={};s.render=function(e,t){return g(e,t)};var o=s.renderFile=function(e,t){var i=s.get(e)||f({filename:e,name:"Render Error",message:"Template not found"});return t?i(t):i};s.get=function(e){var t;if(a[e])t=a[e];else if("object"==typeof document){var i=document.getElementById(e);if(i){var s=(i.value||i.innerHTML).replace(/^\s*|\s*$/g,"");t=g(s,{filename:e})}}return t};var l=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?l(e.call(e)):""),e},r={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},u=function(e){return r[e]},d=function(e){return l(e).replace(/&(?![\w#]+;)|[<>"']/g,u)},p=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},c=function(e,t){var i,s;if(p(e))for(i=0,s=e.length;i<s;i++)t.call(e,e[i],i,e);else for(i in e)t.call(e,e[i],i)},h=s.utils={$helpers:{},$include:o,$string:l,$escape:d,$each:c};s.helper=function(e,t){m[e]=t};var m=s.helpers=h.$helpers;s.onerror=function(e){var t="Template Error\n\n";for(var i in e)t+="<"+i+">\n"+e[i]+"\n\n";"object"==typeof console&&console.error(t)};var f=function(e){return s.onerror(e),function(){return"{Template Error}"}},g=s.compile=function(e,t){function s(i){try{return new r(i,l)+""}catch(s){return t.debug?f(s)():(t.debug=!0,g(e,t)(i))}}t=t||{};for(var o in n)void 0===t[o]&&(t[o]=n[o]);var l=t.filename;try{var r=i(e,t)}catch(e){return e.filename=l||"anonymous",e.name="Syntax Error",f(e)}return s.prototype=r.prototype,s.toString=function(){return r.toString()},l&&t.cache&&(a[l]=s),s},v=h.$each,j="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",y=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,b=/[^\w$]+/g,C=new RegExp(["\\b"+j.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),_=/^\d[^,]*|,\d[^,]*/g,$=/^,+|,+$/g,x=/^$|,+/;n.openTag="{{",n.closeTag="}}";var w=function(e,t){var i=t.split(":"),s=i.shift(),n=i.join(":")||"";return n&&(n=", "+n),"$helpers."+s+"("+e+n+")"};n.parser=function(e,t){e=e.replace(/^\s/,"");var i=e.split(" "),n=i.shift(),a=i.join(" ");switch(n){case"if":e="if("+a+"){";break;case"else":i="if"===i.shift()?" if("+i.join(" ")+")":"",e="}else"+i+"{";break;case"/if":e="}";break;case"each":var o=i[0]||"$data",l=i[1]||"as",r=i[2]||"$value",u=i[3]||"$index",d=r+","+u;"as"!==l&&(o="[]"),e="$each("+o+",function("+d+"){";break;case"/each":e="});";break;case"echo":e="print("+a+");";break;case"print":case"include":e=n+"("+i.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(a)){var p=!0;0===e.indexOf("#")&&(e=e.substr(1),p=!1);for(var c=0,h=e.split("|"),m=h.length,f=h[c++];c<m;c++)f=w(f,h[c]);e=(p?"=":"=#")+f}else e=s.helpers[n]?"=#"+n+"("+i.join(",")+");":"="+e}return e},"function"==typeof define?define("jui/template",[],function(){return s}):"undefined"!=typeof exports?module.exports=s:this.template=s}(),function(e){"function"==typeof define&&define.amd?define("jui/utils",["jquery","jui/template"],e):e(jQuery,template)}(function(e,t){String.prototype.trim=function(e){return this.replace(new RegExp("^"+e+"+|"+e+"+$","g"),"")},String.prototype.prepend=function(e){return this[0]!=e?(e+this).toString():this.toString()},e.jui=e.jui||{},e.jui.template=t,e.jui.tmpl=function(e,i){var s=e;if(/[^\w\-\.:]/.test(e)){s=t.compile(e)(i)}else s=t(e,i);return s},e.jui.utils=e.jui.utils||{},e.jui.utils.isJqObj=function(e){return!!(e&&e.length&&("function"==typeof jQuery||"object"==typeof jQuery)&&e instanceof jQuery)},e.jui.utils.pathCombine=function(){var t="",i=e.makeArray(arguments);return e.each(i,function(e,i){t+=e>0?"/"+i.trim("/"):i.trim("/")}),t},e.jui.utils.parseUrl=function(t){var i={},s="",n=t.indexOf("?"),a="";if(""!=t)if(n>-1){s=t.substring(0,n);var o=t.substring(n+1);a=o;var l=o.split("&");e.each(l,function(e,t){var s,n,a=t.split("=");s=a[0],n=a[1],""!==s&&(i[s]=decodeURIComponent(n))})}else s=t;return{url:t,path:s,query:i,queryStr:a}},e.jui.utils.format=function(t,i){return 1==arguments.length?function(){var i=e.makeArray(arguments);return i.unshift(t),e.format.apply(this,i)}:(arguments.length>2&&i.constructor!=Array&&(i=e.makeArray(arguments).slice(1)),i.constructor!=Array&&(i=[i]),e.each(i,function(e,i){t=t.replace(new RegExp("\\{"+e+"\\}","g"),i)}),t)},e.jui.utils.formatDate=function(){var t=!0,i=arguments[0],s=arguments[1]||"yyyy-MM-dd hh:mm:ss";if("boolean"==typeof i&&(t=i,i=arguments[1],s=arguments[2]||"yyyy-MM-dd hh:mm:ss"),i){var n;new Date;if(i instanceof Date)n=i;else if("number"==typeof i)n=new Date(i);else if("object"==e.type(i)){var a=i.format;i=i.date}else{if("string"!=typeof i)return;if(/Date/.test(i)||!isNaN(i))i=i.replace(/(^\/Date\()|(\)\/$)/g,""),i=parseInt(i),t&&(i-=-288e5),n=new Date(i);else if(/\d{4}.\d{2}.\d{2}/.test(i)){var o=/(\d{4}).(\d{2}).(\d{2}).*/,l=/.*?(\d{1,2}):(\d{1,2}):(\d{1,2})/,r=i.replace(o,"$1,$2,$3").split(","),u=[];l.test(i)&&(u=i.replace(l,"$1,$2,$3").split(",")),n=new Date(r[0],r[1]-1,r[2],u[0]||0,u[1]||0,u[2]||0)}else{if(!/\:/.test(i))return i;var d=/(\d{1,2})([\s\/])(\d{1,2})\2(\d{2,4})/,p=/(\d{2,4})([\s\/\-])(\d{1,2})\2(\d{1,2})/,a=i.split(":")[1];i=i.split(":")[0],"dmy"==a?i=i.replace(d,"$3$2$1$2$4"):"ydm"==a&&(i=i.replace(p,"$1$2$4$2$3")),n=new Date(i),t||(i=n.getTime()+-288e5,n=new Date(i))}}var c=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],h={"M+":n.getMonth()+1,"d+":n.getDate(),"W+":c[n.getDay()],"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};/(y+)/.test(s)&&(s=s.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var m in h)new RegExp("("+m+")").test(s)&&(s=s.replace(RegExp.$1,1==RegExp.$1.length?h[m]:("00"+h[m]).substr((""+h[m]).length)));return s}},e.jui.utils.jsonEqual=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},e.jui.utils.htmlEncode=function(t){return e("<div/>").text(t).html()},e.jui.utils.htmlDecode=function(t){return e("<div/>").html(t).text()},e.jui.utils.getFirstLeaf=function(t,i){i=i||"children";var s=null;if(t.length>0){s=t[0];var n=t[0][i];n&&n.length>0&&(s=e.jui.utils.getFirstLeaf.getFirstLeaf(n))}return s},e.jui.template.helper("formatDate",function(t,i){return i=i||"yyyy-MM-dd",e.jui.utils.formatDate(!1,t,i)}),e.fn.findByName=function(e){return this.find('[name="'+e+'"]')},e.fn.findUntil=function(t,i,s){return s=void 0!==s?s:new jQuery,this.children().each(function(){var n=jQuery(this);n.is(t)&&s.push(this);var a=!1;e.isArray(i)?e.each(i,function(e,t){if(n.is(t))return a=!0,!1}):n.is(i)&&(a=!0),a||n.findUntil(t,i,s)}),s},e.fn.equalHeights=function(){var t=0,i=e(this);return i.each(function(){var i=e(this).outerHeight();i>t&&(t=i)}),i.css("height",t)},e.jui.event=function(){var e={};return{on:function(t,i){e[t]||(e[t]=[]),e[t].push(i)},off:function(t,i){var s=e[t];if(s){for(var n=-1,a=0;a<s.length;a++)if(s[a]===i){n=a;break}n<0||e[t].splice(n,1)}},trigger:function(t){var i=e[t];if(i&&i.length)for(var s=Array.prototype.slice.call(arguments,1),n=0;n<i.length;n++)i[n].apply(this,s)}}}(),e.fn.emulateTransitionEnd=function(t){var i=!1,s=this;e(this).one("bsTransitionEnd",function(){i=!0});var n=function(){i||e(s).trigger(e.support.transition.end)};return setTimeout(n,t),this},e.support.transition=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]};return!1}(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}),function(e){"use strict";if(!e.origin){var t=e.protocol+"//"+e.hostname+(e.port&&":"+e.port);try{Object.defineProperty(e,"origin",{enumerable:!0,value:t})}catch(i){e.origin=t}}}(window.location)}),function(e){"function"==typeof define&&define.amd?define("jui/mixins/compositMixin",["jquery","jqueryui","../utils"],e):e(jQuery)}(function(e){e.jui.compositMixin={options:{components:[],transmitOptions:null},_getComponents:function(){e.isFunction(this.options.components)?this.components=this.options.components.call(this):this.components=this.options.components,this.components||(this.compoents=[])},_renderChildren:function(){var t=this,i=this.options;if(this._getComponents(),this.components&&this.components.length)for(var s=0;s<this.components.length;s++){var n=this.components[s],a=this._findByIdOrName(n.name);if(a.length)if(n.widget){i.transmitOptions&&(n=e.extend(!0,{},i.transmitOptions,n));var o=null;i.transmitData&&t.data&&!e.isEmptyObject(t.data)&&(n.flatData?o=this.data:this.data.hasOwnProperty(n.name)&&(o=this.data[n.name]),void 0===n.data&&(n.data=o)),n=e.extend(!0,{},n,{properties:{name:n.name,parent:t}});var l;if(n.widget.indexOf(".")>0){var r=n.widget.split(".");l=e[r[0]][r[1]]}else l=e.jui[n.widget];l&&(this["$"+n.name]=l(n,a))}else t["_$"+n.name]=a}},findChild:function(e){if(this.components&&this.components.length)for(var t=0;t<this.components.length;t++){var i=this.components[t];if(i.name==e){var s=this["$"+e];return s}}return null}}}),function(e){"function"==typeof define&&define.amd?define("jui/mixins/dataMixin",["jquery","jqueryui","../utils"],e):e(jQuery)}(function(e){e.jui.dataMixin={options:{data:null,dataUrl:null,dataParams:{},dataAjax:{type:"GET",dataType:"json"},dataProcessor:null},_getData:function(t,i){var s=this,n=this.options;this.gettingData=!0,this._fetchData(i).done(function(i){s.data=i,s.data&&s.data.__laf&&(s.data=s.data.Data),e.isFunction(n.dataProcessor)&&(s.data=n.dataProcessor.call(this,i)),s.gettingData=!1,t.call(s)})},_fetchData:function(t){var i=this,s=this.options;return e.Deferred(function(n){if(void 0!=s.data&&null!=s.data){if(!e.isFunction(s.data))return n.resolve(s.data);var a=s.data.call(i);if(!a.done)return n.resolve(a);a.done(function(e){return n.resolve(e)})}else{if(!s.dataUrl)return n.resolve(null);e.isFunction(s.dataUrl)?s.dataAjax.url=s.dataUrl.call(i):s.dataAjax.url=s.dataUrl;var o=s.dataParams;if(e.isFunction(s.dataParams)&&(o=s.dataParams.call(i)),void 0!=t&&(o=e.extend({},o,t)),!s.dataAjax.url)return n.resolve(null);null==o||"application/json"!=s.dataAjax.contentType||e.isPlainObject(o)&&e.isEmptyObject(o)?s.dataAjax.data=o:s.dataAjax.data=JSON.stringify(o),e.ajax(s.dataAjax).done(function(e){return n.resolve(e)})}})}}}),function(e){"function"==typeof define&&define.amd?define("jui/mixins/templateMixin",["jquery","jqueryui","text","../utils"],e):e(jQuery)}(function(e){e.jui.templateMixin={options:{template:null,templateUrl:null},_getTemplate:function(e){var t=this,i=this.options;this._fetchTemplate().done(function(s){t.template=s,i.templateProcessor&&(t.template=i.templateProcessor.call(t,s)),e.call(t)})},_fetchTemplate:function(t){var i=this,s=this.options;return e.Deferred(function(e){if(s.templateUrl)require(["text!/"+s.templateUrl],function(t){e.resolve(t)});else if(s.template)e.resolve(s.template);else{if(!i.elemTmpl){var t=i._find("script");t.length&&(i.elemTmpl=t.html())}e.resolve(i.elemTmpl)}})}}}),function(e){"function"==typeof define&&define.amd?define("jui/jcomponent",["jquery","jqueryui","./utils"],e):e(jQuery)}(function(e){e.widget("jui.jcomponent",{options:{renderIf:!0,showIf:!0,properties:null},_beforeCreate:e.noop,_beforeRender:e.noop,_afterRender:e.noop,_render:e.noop,_refresh:e.noop,_create:function(){var t=this,i=this.options;i.properties&&e.each(i.properties,function(e,i){t[e]=i}),this.__beforeCreate(),this.showIf=i.showIf,e.isFunction(i.showIf)&&(this.showIf=i.showIf.call(t)),0==this.showIf&&this.element.hide(),this.renderIf=i.showIf,e.isFunction(i.renderIf)&&(this.renderIf=i.renderIf.call(t)),i.renderIf&&this.__render()},show:function(){this._show(this.widget())},hide:function(){this._hide(this.widget())},__render:function(){var e=this,t=this.options;1!=this.rendered&&(this.rendered=!0,null!=t.styleClass&&e.element.addClass(t.styleClass),null!=t.style&&e.element.css(t.style),this._render(),this.options.disabled&&this.disable(),t.events&&e._on(t.events))},refresh:function(t){this.options=e.extend(!0,this.options,t),this.rendered?this._refresh():this.__render()},_refresh:function(){this.element.html(""),this.rendered=!1,this.__render()},_findByIdOrName:function(e){var t=this.widget().find("#"+e);return t.length||(t=this.widget().findByName(e)),t},_find:function(e){return this.widget().find(e)},_getCreateEventData:function(){return{inst:this}},__beforeCreate:function(){e.isFunction(this.options.beforeCreate)&&this.options.beforeCreate.call(this),this._beforeCreate()},__beforeRender:function(){e.isFunction(this.options.beforeRender)&&this.options.beforeRender.call(this),this._beforeRender()},__afterRender:function(){e.isFunction(this.options.afterRender)&&this.options.afterRender.call(this),this._afterRender()},isHidden:function(){return this.widget().is(":hidden")},isDisabled:function(){return this.options.disabled},on:function(e,t){var i=this,s=this.widgetEventPrefix.toLowerCase();e=e.toLowerCase(),this.element.bind(s+e,function(e,s){t.call(i,e,s)})}})}),function(e){"function"==typeof define&&define.amd?define("jui/jtmpl",["jquery","jqueryui","./utils","./jcomponent","./mixins/templateMixin","./mixins/dataMixin","./mixins/compositMixin"],e):e(jQuery)}(function(e){e.widget("jui.jtmpl",e.jui.jcomponent,e.extend(!0,{},e.jui.templateMixin,e.jui.compositMixin,e.jui.dataMixin,{options:{asHtml:!0},_render:function(){this.refresh()},refresh:function(t){var i=this;this.options=e.extend(!0,this.options,t);var s=this.options;i._getTemplate(function(){i.element.html(""),i._getData(function(){i.__beforeRender();var t=i.template;i.template&&i.data&&(t=e.jui.tmpl(i.template,i.data)),s.asHtml?i.element.html(t):i.element.text(t),i._renderChildren(),i.__afterRender()})})}}))}),function(e){"function"==typeof define&&define.amd?define("jui/misc/jpager",["jquery","jqueryui","../utils"],e):e(jQuery)}(function(e){e.widget("jui.jpager",{options:{pageIndex:1,pageSize:10,total:0,fields:{pageIndex:"pageIndex",pageSize:"pageSize"},displayItemCount:5,edgeItemCount:1,linkTo:"#",prevShowAlways:!0,nextShowAlways:!0,styleClass:"pagination",cssClasses:{widget:"jpager",itemContainer:"jpager-items",item:"jpager-item",itemSelected:"jpager-item-selected",info:"jpager-info"},selectors:{widget:".jpager",itemContainer:".jpager-items",item:".jpager-item",info:".jpager-info"},templates:{layout:'<div class="cell"><ul class="jpager-items"></ul></div><div class="jpager-info cell"></div><div class="cell-fit"></div>',item:'<li><a href="javascript:;">{{text}}</a></li>'},pageChanged:function(e,t){},texts:{info:"每页{{pageSize}}条，共{{total}}条",prev:"上一页",next:"下一页",ellipse:"..."}},_$itemContainer:null,_$pagerInfo:null,_bound:!1,_create:function(){var e=this.options;this.element.addClass(e.cssClasses.widget),e.templates.layout&&this.element.append(e.templates.layout),this._$itemContainer=this.element.find(e.selectors.itemContainer),this._$itemContainer.length||(this._$itemContainer=this.element.addClass(e.cssClasses.itemContainer)),this._$pagerInfo=this.element.find(e.selectors.info)},bind:function(t){var i=e.extend({},{total:this.options.total,pageIndex:this.options.pageIndex,pageSize:this.options.pageSize},t);this._bound?i.total==this.options.total&&i.pageIndex==this.options.pageIndex&&i.pageSize==this.options.pageSize||this._bindData(i):(this._bindData(i),this._bound=!0)},_bindData:function(t){this.options=e.extend(this.options,t),this._createPageItems(),this._createPagerInfo()},_createPageItems:function(){this._$itemContainer.empty();var t=this,i=this.options,s=i.pageIndex,n=this._getInterval(),a=this._getPageCount(),o=function(e){return function(i){return t._pageSelected(e,i)}},l=function(n,l){n=n<1?1:n<a?n:a,l=jQuery.extend({text:n,classes:""},l||{});var r=e(e.jui.tmpl(i.templates.item,{text:l.text})).addClass(i.cssClasses.item);l.space||(n==s?(r.addClass("active"),r.addClass(i.cssClasses.itemSelected)):r.bind("click",o(n))),l.classes&&r.addClass(l.classes),t._$itemContainer.append(r)};if(i.texts.prev&&(s>1||i.prevShowAlways)&&l(s-1,{text:i.texts.prev,classes:"prev"}),n[0]>1&&i.edgeItemCount>0){for(var r=Math.min(i.edgeItemCount,n[0]-1),u=1;u<=r;u++)l(u);i.edgeItemCount<n[0]-1&&i.texts.ellipse&&l(null,{text:i.texts.ellipse,classes:"space",space:!0})}for(var u=n[0];u<=n[1];u++)l(u);if(n[1]<a&&i.edgeItemCount>0){a-i.edgeItemCount>n[1]&&i.texts.ellipse&&l(null,{text:i.texts.ellipse,classes:"space",space:!0});for(var d=Math.max(a-i.edgeItemCount+1,n[1]),u=d;u<=a;u++)l(u)}i.texts.next&&(s<a||i.nextShowAlways)&&l(s+1,{text:i.texts.next,classes:"next"})},_createPagerInfo:function(){if(this._$pagerInfo.length){var t=e.jui.tmpl(this.options.texts.info,{total:this.options.total,pageSize:this.options.pageSize});this._$pagerInfo.html(t)}},_getInterval:function(){var e=this.options,t=e.pageIndex,i=Math.floor(e.displayItemCount/2),s=this._getPageCount(),n=s-e.displayItemCount;return[t>i?Math.max(Math.min(t-i,n),1):1,t>i?Math.min(t+i,s):Math.min(e.displayItemCount,s)]},_getPageCount:function(){return Math.ceil(this.options.total/this.options.pageSize)},_pageSelected:function(e){this.options.pageIndex=e,this._createPageItems();var t=this._trigger("pageChanged",null,{pageIndex:this.options.pageIndex,pageSize:this.options.pageSize});return t||(evt.stopPropagation?evt.stopPropagation():evt.cancelBubble=!0),t}})}),function(e){"function"==typeof define&&define.amd?define("jui/misc/jcollapse",["jquery","jqueryui","../utils"],e):e(jQuery)}(function(e){e.widget("jui.jcollapse",{options:{trigger:".jcollapse-trigger",target:".jcollapse-target",triggerType:"click",icons:{on:"fa fa-angle-up",off:"fa fa-angle-down"},multiple:!1,active:!1},_init:function(){var t=this,i=this.options;this.$trigger=this.element.find(this.options.trigger),this.$target=this.element.find(this.options.target),this.$trigger.each(function(s,n){var a=e(n),o=t.$target.eq(s),l=a.find(".jcollapse-icon");l.addClass(i.icons.off);var r={};r[i.triggerType]=function(s){a.is(".jcollapse-trigger-on")?(a.removeClass("jcollapse-trigger-on"),o.removeClass("jcollapse-on"),l.removeClass(i.icons.on).addClass(i.icons.off)):(i.multiple||(t.$trigger.filter(".jcollapse-trigger-on").each(function(){e(this).removeClass("jcollapse-trigger-on"),e(this).find(".jcollapse-icon").removeClass(i.icons.on).addClass(i.icons.off)}),t.$target.removeClass("jcollapse-on")),a.addClass("jcollapse-trigger-on"),o.addClass("jcollapse-on"),t._trigger("beforeShow",s,{trigger:a,target:o}),l.removeClass(i.icons.off).addClass(i.icons.on))},t._off(a,i.triggerType),t._on(a,r)}),!1!==i.active&&this.$trigger.eq(i.active).trigger(i.triggerType)}})}),function(e){"function"==typeof define&&define.amd?define("jui/spa",["jquery","jqueryui","text","./utils","./jcomponent","./mixins/compositMixin","./mixins/dataMixin"],e):e(jQuery)}(function(e){var t=function(t){var i=this;this.hash=void 0===t?location.hash:t,this.hash||(this.hash="#"+e.router.defaults.path),this.path=this.hash.substring(1),this.paths=[null,null,null],this.query={},this.queryStr="";var s=this.hash.indexOf("?");if(this.hash.length>1&&s>-1){this.path=this.hash.substring(1,s);var n=this.queryStr=this.hash.substring(s+1),a=n.split("&");e.each(a,function(e,t){var s,n,a=t.split("=");s=a[0],n=a[1],""!==s&&(i.query[s]=decodeURIComponent(n))})}var o=this.path.split("!");this.maxLevel=o.length-1,o.length<=3&&e.each(o,function(e,t){i.paths[e]=t})};e.router={defaults:{viewsDir:"app/views",routerElem:"#App",path:"!"},routes:{current:null,previous:null},routePathMap:{}},e.router.start=function(i){i&&(e.router.defaults=e.extend(e.router.defaults,i)),function(){e(window).bind("hashchange",function(){var i=new t,s=null,n=!1;if(e.router.routes.previous=e.router.routes.current,e.router.routes.current=i,null!=e.router.routes.previous){var a=e.router.routes.current.paths,o=e.router.routes.previous.paths;a[0]!=o[0]?s=0:a[1]!=o[1]?s=1:a[2]!=o[2]?s=2:(e.router.routes.previous.queryStr||"")!=e.router.routes.current.queryStr&&(n=!0)}e.jui.event.trigger("hashChange",{route:i,changedLevel:s,queryChanged:n})}),e(window).trigger("hashchange"),e(e.router.defaults.routerElem).jrouter({level:0})}()},e.router.go=function(t){t=e.extend(!0,{},e.router.routes.current,t);for(var i="",s=0;s<=t.maxLevel;s++)i+=t.paths[s],s<t.maxLevel&&(i+="!");t.query&&(i+="?"+e.param(t.query)),window.location.hash="#"+i},e.widget("jui.jrouter",e.jui.jcomponent,{options:{url:null,level:null,viewOptions:null},_render:function(){var t=this,i=this.options;this.element.attr("level",i.level),this.element.addClass("jrouter"),null!=i.level?(this.go(this._getRouteUrl()),e.jui.event.on("hashChange",t.__hashChange=function(e){t._hashChange(e)})):i.url&&this.go(i.url)},go:function(t){var i=this,s=this.options,n=t;if(this.options.level||(this.options.url=t),"$"==t[0])if("/"==t[1])t=t.substring(2);else{t=t.substring(1);var a=t.split("/"),o=e.router.routePathMap[a[0]];t=e.jui.utils.pathCombine(o,t.substring(a[0].length))}else t=e.jui.utils.pathCombine(e.router.defaults.viewsDir,t);var l=e.jui.utils.parseUrl(t),r=l.path.replace(/\./g,"_"),u=l.path+".html";l.queryStr&&(u=u+"?"+l.queryStr);var d=l.path+".js";u=u.prepend("/"),d=d.prepend("/"),require(["text!"+u],function(t){var a=e(t);a.attr("view",n),i.element.html(a),require([d],function(t){e.views[r]||e.widget("views."+r,e.jui.jview,t);var n={properties:{urlData:l,route:e.router.routes.current,router:i,routerData:i.options.data}};n=e.extend(!0,{},n,s.viewOptions),i.view=e.views[r](n,a)})})},_refresh:function(){e.isNumeric(this.options.level)?this.go(this._getRouteUrl()):this.options.url&&this.go(this.options.url)},_getRouteUrl:function(){function t(i,n){return 0==n?i:"/"!=i[0]&&"$"!=i[0]?(i=e.jui.utils.pathCombine(s[n-1],i),t(i,n-1)):i}var i=this.options.level,s=e.router.routes.current.paths,n=e.router.routes.current.maxLevel,a=s[i];return i<n&&(a=e.jui.utils.pathCombine(a,"_layout")),a=t(a,i),e.router.routes.current.queryStr.length>0&&(a=a+"?"+e.router.routes.current.queryStr),a},_hashChange:function(e){e.changedLevel==this.options.level&&this.refresh()},_destroy:function(){e.jui.event.off("hashChange",this.__hashChange)}}),e.views={},e.widget("jui.jview",e.jui.jcomponent,e.extend(!0,{},e.jui.compositMixin,e.jui.dataMixin,{options:{pageTitle:null,defaultSubpath:null,subviewOptions:null},_subpathChanged:e.noop,_queryChanged:e.noop,_hashChanged:e.noop,_afterRender:e.noop,_render:function(){var t=this,i=this.options;this.element.addClass("jview"),this._getData(function(){this.__beforeRender(),i.pageTitle&&(document.title=i.pageTitle),this.subLevel=this.router.options.level+1,this._renderChildren(),e.jui.event.on("hashChange",t.__hashChange=function(e){t._hashChange(e)}),i.defaultSubpath&&(this.subRouterElem=this._find(".jrouter"),this.route.paths[this.subLevel]||(this.route.paths[this.subLevel]=e.isFunction(i.defaultSubpath)?i.defaultSubpath.call(t):i.defaultSubpath),this.subRouterElem.jrouter({level:this.subLevel,viewOptions:i.subviewOptions}),this._subpathChanged()),this.__afterRender()})},_hashChange:function(t){this.route=e.router.routes.current;var i=this,s=i.options;this._hashChanged(),s.defaultSubpath&&t.changedLevel==this.subLevel&&this._subpathChanged(),t.queryChanged&&this._queryChanged()},queryChanged:function(t){return!e.router.routes.previous.query||e.router.routes.previous.query[t]!=e.router.routes.current.query[t]},_destroy:function(){e.jui.event.off("hashChange",this.__hashChange)}}))}),function(e){"function"==typeof define&&define.amd?define("jui/layers/jlayer",["jquery","jqueryui","../jcomponent","../mixins/templateMixin","../mixins/dataMixin","../mixins/compositMixin","../spa"],e):e(jQuery)}(function(e){var t={};t.zIndex=2009,e.widget("jui.jlayer",e.jui.jcomponent,e.extend(!0,{},e.jui.templateMixin,e.jui.compositMixin,e.jui.dataMixin,{options:{appendTo:"body",insertAfter:null,modal:!1,asHtml:!0,backdrop:!1,closeOnClickBackdrop:!1,backdropBackground:"#000",backdropOpacity:.5,hideOnClickDoc:!1,closeOnClickDoc:!1,autoRender:!0,autoShow:!0,showAnimate:null,hideAnimate:null,fitElem:"",follow:null,align:null,position:null,size:{width:null,height:null,minWidth:"none",minHeight:"none",maxWidth:"none",maxHeight:"none"},attachElem:null},_render:function(){var t=this,i=this.options;if(this._rendered=!1,this.$body=e("body"),this.dismiss='[data-dismiss="jlayer"]',this.element.addClass("jlayer"),this.$wrapper=this.element,i.modal)this.$wrapper=e('<div class="jlayer-modal"></div>').hide(),this.element.appendTo(this.$wrapper),this.$wrapper.appendTo("body");else{if(this.element.hide(),i.align){i.position={of:window,collision:"flipfit",using:function(t){var i=e(this).css(t).offset().top;i<0&&e(this).css("top",t.top-i)}};var s=i.align.split(" ");if(1===s.length&&(s[1]="center"),i.follow&&!i.followInner){i.position.of=e(i.follow);var n=["center","center"],a=["center","center"];"left"==s[1]?(n[0]="left",a[0]="left"):"right"==s[1]?(n[0]="right",a[0]="right"):"top"==s[1]?(n[1]="top",a[1]="top"):"bottom"==s[1]&&(n[1]="bottom",a[1]="bottom"),"top"==s[0]?(n[1]="bottom",a[1]="top"):"bottom"==s[0]?(n[1]="top",a[1]="bottom"):"left"==s[0]?(n[0]="right",a[0]="left"):"right"==s[0]&&(n[0]="left",a[0]="right"),i.position.my=n[0]+" "+n[1],i.position.at=a[0]+" "+a[1]}else{var o=/left|center|right/,l=/top|center|bottom/,r=i.align.split(" ");1===r.length&&(r=o.test(r[0])?r.concat(["center"]):l.test(r[0])?["center"].concat(r):["center","center"]),r[0]=o.test(r[0])?r[0]:"center",r[1]=l.test(r[1])?r[1]:"center",i.position.my=r[0]+" "+r[1],i.follow?i.position.of=e(i.follow):i.position.at=r[0]+" "+r[1],i.position.my=r[0]+" "+r[1],i.position.at=r[0]+" "+r[1]}}i.position&&(this.element.css("position",i.fixed?"fixed":"absolute"),i.follow?i.position.of=e(i.follow):i.appendTo&&"body"!=i.appendTo?i.position.of=i.appendTo:i.position.of=window),this.$appendTo=e(i.appendTo),this.appendToIsBody=this.$appendTo.is("body"),this.$backdrop=e('<div class="jlayer-backdrop" style="display:none;" />'),this._isShown=!1,i.appendTo&&this._on(!0,e(i.appendTo),{remove:function(s){s.target===e(i.appendTo)[0]&&t&&t.close()}}),i.insertAfter?this.element.insertAfter(i.insertAfter):i.appendTo&&this.element.appendTo(i.appendTo),i.backdrop&&this.setBackdrop(),this.element.find(t.dismiss).on("click",function(){t.options.modal?t.close():t.hide()})}i.attachElem&&this._on(!0,e(i.attachElem),{remove:function(s){s.target===e(i.attachElem)[0]&&t&&t.close()}})},_init:function(){this.options.autoRender&&this.refresh(null,this.options.autoShow)},refresh:function(t,i){t&&(this.options=e.extend(this.options,t));var s=this,n=this.options;n.url?this.element.jrouter({url:n.url,data:n.data,viewOptions:{properties:{layer:s},afterRender:function(e,t){s.element.find(s.dismiss).on("click",function(){s.options.modal?s.close():s.hide()}),s._rendered=!0,i&&s.show()}}}):s._getTemplate(function(){s._getData(function(){s.__beforeRender();var t=this.template;this.template&&this.data&&(t=e.jui.tmpl(this.template,this.data)),n.asHtml?s.element.html(t):s.element.text(t),s.element.find(s.dismiss).on("click",function(){s.options.modal?s.close():s.hide()}),s._renderChildren(),s._rendered=!0,i&&s.show(),s.__afterRender()})})},show:function(){var e=this;if(!this._rendered)return void this.refresh(null,!0);this._trigger("showing",null,null),this.setSize(),this.setPosition(),this.__show(),this._focus(),(this.options.position||this.options.modal)&&(e._off(e.window,"resize"),e._on(e.window,{resize:function(){e._isShown&&(e.setSize(),e.setPosition())}}))},__show:function(){var e=this;this._isShown||(this.setzIndex(),this.options.backdrop&&this.$backdrop.show(),this.options.modal&&(this.checkScrollbar(),this.setScrollbar()),this.options.showAnimate&&this.$wrapper.addClass(this.options.showAnimate+" animated"),this._show(this.$wrapper,this.options.show,function(){e.$wrapper.removeClass(e.options.showAnimate+" animated"),e._trigger("shown",null),e._docClickHandler()})),this._isShown=!0},hide:function(e){var t=this;void 0!==e&&(t.returnValue=e),this.$backdrop.hide(),this.$appendTo.data("container.static")&&this.$appendTo.css("position",""),this._isShown=!1,this._hide(this.$wrapper,this.options.hide,function(){t._trigger("hidden",null,e)}),t._off(t.window,"resize")},isShown:function(){return this._isShown},close:function(t){var i=this;void 0!==t&&(i.returnValue=t),e.support.transition&&null!=this.options.hideAnimate?this.element.addClass(this.options.hideAnimate+" animated").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){i._close(t)}):this._close(t)},_close:function(e){if(this._trigger("closed",null,{result:e}),this._off(this.window,"resize"),this.$wrapper.remove(),this.options.modal){var t=this.$body.data("modalCount");t&&(t--,this.$body.data("modalCount",t),0==t&&this.resetScrollbar())}this.options.backdrop&&(this.$backdrop.remove(),this.$appendTo.data("container.static")&&this.$appendTo.css("position",null))},setSize:function(){var t=this,i=this.options;this.$fitElem=this.element.find(i.fitElem),this.hasFitElem=this.$fitElem.length>0;var s=i.size;s.height;if(this.hasFitElem){"auto",this.$fitElem.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0,boxSizing:"content-box"});var n,a=this.element.css({height:"auto",width:s.width}).outerHeight();n="number"==typeof s.height?s.height:i.modal||t.$appendTo.is("body")?e(window).height():t.$appendTo.height(),this.$fitElem.css("maxHeight",n-a),this.$fitElem.css("height","auto")}"number"==typeof s.maxWidth&&"number"==typeof s.minWidth&&(s.maxWidth=Math.max(s.maxWidth,s.minWidth)),"number"==typeof s.width&&(s.minWidth="none",
"number"==typeof s.maxWidth&&s.maxWidth>s.width&&(s.maxWidth=s.width)),this.element.css({maxWidth:s.maxWidth,minWidth:s.minWidth,maxHeight:s.maxHeight,minHeight:s.minHeight,width:s.width,height:s.height}),this._trigger("sized",null,null)},setPosition:function(){if(!this.options.modal&&this.options.position){var e=this.element.is(":visible");e||this.element.show(),this.element.position(this.options.position),e||this.element.hide(),this.appendToIsBody||this.$backdrop.css({position:"absolute",width:this.$appendTo.width()+"px",height:this.$appendTo.height()+"px"})}},setzIndex:function(){var e=t.zIndex++;this.$wrapper.css("zIndex",e),this.options.backdrop&&this.$backdrop.css("zIndex",e-1),this.zIndex=e},setBackdrop:function(){var t=this,i=this.options,s=this.$backdrop,n={position:"fixed",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",userSelect:"none",opacity:0,background:this.options.backdropBackground};this.appendToIsBody||(e.extend(n,{position:"absolute",width:this.$appendTo.width()+"px",height:this.$appendTo.height()+"px"}),"static"==this.$appendTo.css("position")&&(this.$appendTo.css("position","relative"),this.$appendTo.data("container.static",!0))),s.css(n).animate({opacity:this.options.backdropOpacity},150).insertAfter(this.element).attr({tabindex:"0"}),i.closeOnClickBackdrop&&t._on(s,{click:function(e){e.target===e.currentTarget&&t.close()}})},_focus:function(){var e=this.element.find("[autofocus]");e.focus(),e.eq(0).trigger("focus")},getBackdrop:function(){return this.$backdrop},_docClickHandler:function(){var t=this;t.options.closeOnClickDoc&&t._on(t.document,{mousedown:function(i){var s=e(i.target).closest(".jlayer");if(s.length){s.jlayer("instance").zIndex<t.zIndex&&(t.close(),t._off(t.document,"mousedown touchstart"))}else t.close(),t._off(t.document,"mousedown touchstart")}}),this.options.hideOnClickDoc&&this._on(this.document,{mousedown:function(i){var s=e(i.target).closest(".jlayer");if(s.length){s.jlayer("instance").zIndex<t.zIndex&&(t.hide(),t._off(t.document,"mousedown touchstart"))}else t.hide(),t._off(t.document,"mousedown touchstart")}})},_destroy:function(){this.options.modal&&(this.$backdrop.remove(),this.$appendTo.data("container.static")&&this.$appendTo.css("position","static"))},checkScrollbar:function(){var t=window.innerWidth;if(!t){var i=document.documentElement.getBoundingClientRect();t=i.right-Math.abs(i.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=e.position.scrollbarWidth()},setScrollbar:function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.originalBodyOverflow=document.body.style.overflow||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth),this.$body.css("overflow","hidden");var t=this.$body.data("modalCount");t?(t++,this.$body.data("modalCount",t)):this.$body.data("modalCount",1)},resetScrollbar:function(){this.$body.css("padding-right",this.originalBodyPad),this.$body.css("overflow",this.originalBodyOverflow),this.$body.removeData("modalCount")}}))}),function(e){"function"==typeof define&&define.amd?define("jui/layers/jpop",["jquery","jqueryui","./jlayer"],e):e(jQuery)}(function(e){e.widget("jui.jpop",{options:{trigger:null,triggerType:"click",layerElem:null,layer:{autoShow:!1,align:"bottom left",position:{my:"left top",at:"left bottom",collision:"flipfit",using:function(t){var i=e(this).css(t).offset().top;i<0&&e(this).css("top",t.top-i)}}},hideOnClickAnywhere:!1},_create:function(){var t=this.options;t.layerElem&&(this.$layer=e(t.layerElem)),this.$layer&&this.$layer.length||(this.$layer=e("<div>")),this.options.trigger&&(this.$trigger=e(this.options.trigger)),this.$trigger&&this.$trigger.length||(this.$trigger=this.element),this.$trigger.addClass("jpop-trigger"),this.element.addClass("jpop"),this.$layer.addClass("jpop-layer"),t.layer.follow=this.element,t.relEl=this.$trigger,this.$layer.jlayer(t.layer)},_init:function(){this._bindTrigger()},_bindTrigger:function(){"click"===this.options.triggerType?this._bindClick():this._bindHover()},_bindClick:function(){var t=this,i=this.options;this._on(this.$trigger,{click:function(s){function n(s){(i.hideOnClickAnywhere||s.target!==e(t.options.relEl)[0]&&!e(s.target).closest(t.options.relEl).length&&!e(s.target).closest(t.$layer).length)&&(t.$layer.jlayer("hide"),t._off(t.document,"mousedown touchstart"))}t.$layer.jlayer("isShown")?(t.$layer.jlayer("hide"),t._off(t.document,"mousedown touchstart")):(t.$layer.jlayer("show"),t._on(t.document,{mousedown:e.proxy(n,t)}))}})},_bindHover:function(){function e(e){clearTimeout(t),t=null,n.$layer.jlayer("isShown")&&(i=setTimeout(function(){n.$layer.jlayer("hide")},s))}var t,i,s=100,n=this;this._on(this.$trigger,{mouseenter:function(e){clearTimeout(i),i=null,t=setTimeout(function(){n.$layer.jlayer("show")},s)},mouseleave:e}),n.$layer.on("mouseenter",function(){clearTimeout(i)}),n.$layer.on("mouseleave",e)},_destroy:function(){this.$layer.jlayer("close")},hide:function(){this.$layer.jlayer("hide")},getLayer:function(){return this.$layer}})}),function(e){"function"==typeof define&&define.amd?define("jui/layers/jlayer.modal",["jquery","./jlayer"],e):e(jQuery)}(function(e){e.jui.modal=function(t){return t=e.extend(!0,{},t,{modal:!0,hideAnimate:"fadeOutUp",showAnimate:"fadeInDown",size:{maxHeight:"fit"},fitElem:".modal-bd",closeOnClickBackdrop:!0}),$layer=e("<div>"),$layer.jlayer(t),$layer}}),function(e){"function"==typeof define&&define.amd?define("jui/layers/jlayer.alert",["jquery","./jlayer"],e):e(jQuery)}(function(e){e.jui.alert=function(t){var i=null;t=e.extend(!0,{},{appendTo:"body",follow:null,type:null,icon:null,message:null,description:null,showClose:!0,backdrop:!0,size:{maxWidth:416},position:{my:"center center",at:"center center",of:window},template:'<div class="jalert jalert-{{type}}"><div class="jalert-content-wrapper"><div class="jalert-icon"><i class="{{icon}}"></i></div><div class="jalert-content">{{if message}}<div class="jalert-message" name="message"></div>{{/if}}{{if description}}<div class="jalert-description" name="description">{{#description}}</div>{{/if}}</div></div>{{if commands}}<ul class="jalert-commands" name="commands"></ul>{{/if}}</div>{{if showClose}}<div class="jalert-close"><span class="jlayer-close" data-dismiss="jlayer" style="display: block;"></span></div>{{/if}}'},t,{modal:!1}),t.data={type:t.type,message:t.message,description:t.description,icon:t.icon,showClose:t.showClose,commands:t.commands};var s=[];if(t.message){var n={name:"message",widget:"jtmpl"};"string"==typeof t.message?n.template=t.message:n=e.extend(!0,{},n,t.message),s.push(n)}if(t.description){var a={name:"description",widget:"jtmpl"};"string"==typeof t.description?a.template=t.description:a=e.extend(!0,{},a,t.description),s.push(a)}var o=null;return t.commands&&(o={name:"commands",widget:"jlistCommands"},o=e.extend(!0,{},o,t.commands),s.push(o)),t.components=s,i=e("<div>").jlayer(t).jlayer("instance"),null!=o&&(i.$commands.options.target=i),i},e.jui.alert.info=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},{type:"info",icon:"fa fa-info-circle",commands:{data:[{text:"确定",styleClass:"bg-primary",command:function(e){e.close()}}]}},t),e.jui.alert(t)},e.jui.alert.success=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},{type:"success",icon:"fa fa-check-circle",commands:{data:[{text:"确定",styleClass:"bg-primary",command:function(e){e.close()}}]}},t),e.jui.alert(t)},e.jui.alert.warning=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},t,{type:"warning",icon:"fa fa-exclamation-circle",commands:{data:[{text:"确定",styleClass:"bg-primary",command:function(e){e.close()}}]}}),e.jui.alert(t)},e.jui.alert.error=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},t,{type:"error",icon:"fa fa-times-circle",duration:!1,showClose:!0,commands:{data:[{text:"确定",styleClass:"bg-primary",command:function(e){e.close()}}]}}),e.jui.alert(t)},e.jui.alert.confirm=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},{type:"confirm",icon:"fa fa-question-circle",showClose:!0,onOk:null,commands:{data:[{text:"确定",styleClass:"bg-primary",command:function(t){t.close(),t&&e.isFunction(t.options.onOk)&&t.options.onOk()}},{text:"取消",command:function(e){e.close()}}]}},t),e.jui.alert(t)}}),function(e){"function"==typeof define&&define.amd?define("jui/layers/jlayer.tip",["jquery","./jlayer"],e):e(jQuery)}(function(e){e.jui.tip=function(t){var i=null;t=e.extend(!0,{},{appendTo:"body",follow:null,type:null,icon:null,message:null,duration:2,showClose:!1,tipElem:null,position:{my:"center center",at:"center center",of:window},closeToHide:!1,template:'<div class="jtip-inner">{{if icon}}<div class="jtip-icon"><i class="{{icon}}"></i></div>{{/if}}{{if message}}<div class="jtip-message" name="message"></div>{{/if}}{{if commands}}<ul class="jtip-commands" name="commands"></ul>{{/if}}</div>',data:{message:t.message,description:t.description,icon:t.icon,showClose:t.showClose,commands:t.commands}},t,{modal:!1});var s=[],n={name:"message",widget:"jtmpl"};"string"==typeof t.message?n.template=t.message:n=e.extend(!0,{},n,t.message),s.push(n);var a=null;if(t.showClose){var o={icon:"fa fa-remove",styleClass:"btn-link",command:function(e){t.closeToHide?e.hide():e.close()}};t.commands?t.commands.data.push(o):t.commands={data:[o]}}var a=null;t.commands&&(a={name:"commands",widget:"jlistCommands",itemStyleClass:"btn-link"},a=e.extend(!0,{},a,t.commands),s.push(a)),t.data.commands=t.commands,t.components=s;var l=e('<div class="jtip">');return t.tipElem&&(l=e(t.tipElem).addClass("jtip"),t.appendTo=null,t.insertAfter=null,t.position=null),t.type&&l.addClass("jtip-"+t.type),l.jlayer(t),i=l.jlayer("instance"),null!=a&&(i.$commands.options.target=i),t.duration&&setTimeout(function(){i.close()},1e3*t.duration),i.message=function(e){var t=e;"string"==typeof e&&(t={template:e}),this.$message.refresh(t),this.setPosition()},i},e.jui.tip.info=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},{type:"info",icon:"fa fa-info-circle"},t),e.jui.tip(t)},e.jui.tip.success=function(t){return t=t||{},"string"==typeof t&&(t={message:t}),t.icon=t.icon||"fa fa-check-circle fa-2x",t.message||(t.styleClass="jtip-nobg"),t=e.extend(!0,{},{type:"success",hideAnimate:"fadeOutUp",duration:.5},t),e.jui.tip(t)},e.jui.tip.warning=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},{type:"warning",icon:"fa fa-exclamation-circle",duration:!1,showClose:!0},t),e.jui.tip(t)},e.jui.tip.error=function(t){return"string"==typeof t&&(t={message:t}),t=e.extend(!0,{},{type:"error",icon:"fa fa-times-circle",duration:!1,showClose:!0},t),e.jui.tip(t)},e.jui.tip.loading=function(t){t=t||{};var i=null;if(i="string"==typeof t?{message:t}:e.extend(!0,{},t),!i.icon){var s=i.img||'<img src="/assets/img/loading.gif"></img>';i.message?i.message=s+" "+i.message:i.message=s}return i=e.extend(!0,{},{type:"loading",styleClass:"jtip-nobg",backdrop:!0,backdropBackground:"#ccc",backdropOpacity:.3,duration:!1},i),e.jui.tip(i)}}),function(e){"function"==typeof define&&define.amd?define("jui/utils.ajax",["jquery","./utils","./layers/jlayer.tip","./layers/jlayer.modal"],e):e(jQuery)}(function(e){e.jui=e.jui||{},e.jui.loginPath="",e.jui.accessDeniedPath="/admin/#liteaf.membership/spa/auth/accessDenied",e.jui.ajax=function(t){t=t||{};var i=null,s=null,n=e.extend(!0,{loadingTip:{},successTip:{},errorTip:{tipMode:!1,tipElem:null}},t);return n.beforeSend=function(){if(n.loadingTip&&(i=e.jui.tip.loading(n.loadingTip)),null!=n.errorTip.tipElem){n.errorTip.closeToHide=!0;var s=e(n.errorTip.tipElem).jlayer("instance");void 0!=s&&s.hide()}t.beforeSend&&t.beforeSend.apply(this,arguments)},n.success=function(a){if(i&&i.close(),a&&0==a.Success){if(n.errorTip){var o,l=e.extend(!0,{},n.errorTip);return e.isArray(a.Errors)&&a.Errors.length&&(o={template:"<ul>{{each Errors as value}}<li>{{value}}</li>{{/each}}</ul>",data:{Errors:a.Errors}}),l.message=a.Message,l.description=o,a.UnLogined&&(l.closed=function(t,i){location.href=e.jui.loginPath}),a.UnAuthed&&(l.closed=function(t,i){location.href=e.jui.accessDeniedPath}),void(l.tipMode||l.tipElem?e.jui.tip.error(l):e.jui.alert.error(l))}}else n.successTip&&(s=e.jui.tip.success(n.successTip));t.success&&t.success.apply(this,arguments),a&&null!=a&&a.RedirectUrl&&(top.location=a.RedirectUrl)},n.complete=function(){i&&i.close(),t.complete&&t.complete.apply(this,arguments)},n.__responseHandled=!0,jQuery.ajax(n)},e.jui.postJson=function(t){return t=e.extend({},t,{type:"POST",dataType:"json",contentType:"application/json",loading:{},notifySuccess:{}}),t.data&&e.isPlainObject(t.data)&&"application/json"==t.contentType&&(t.data=JSON.stringify(t.data)),e.jui.ajax(t)},e.jui.getJson=function(t){return t=e.extend({},t,{type:"GET",dataType:"json"}),e.jui.ajax(t)},e(document).ajaxComplete(function(t,i,s){try{var n=e.parseJSON(i.responseText)}catch(t){return}n&&null!=n&&(n.UnLogined&&(location.href=e.jui.loginPath),n.UnAuthed&&(location.href=e.jui.accessDeniedPath))}),e(document).ajaxError(function(t,i,s){try{var n=e.parseJSON(i.responseText)}catch(t){return}if(n&&null!=n&&n.RedirectUrl&&(top.location=n.RedirectUrl),n&&null!=n&&n.Message){var a=e.jui.utils.htmlEncode(n.Message);a=a.replace(/\n/g,"<br>");e.jui.modal({data:{msg:a},template:'<div class="modal"><div class="modal-hd"><div class="navbar"><div class="navbar-hd"><h4>系统错误</h4></div><div class="navbar-ft"><span data-dismiss="jlayer" class="jlayer-close" id="btnClose"></span></div></div></div><div class="modal-bd"><p>{{#msg}}</p></div><div class="modal-ft"><button type="button" class="btn" data-role="cancel" data-dismiss="jlayer">关闭</button></div></div>'})}})}),function(e){"function"==typeof define&&define.amd?define("jui/lists/jlist",["jquery","jqueryui","../jcomponent","../utils","../misc/jpager","../mixins/dataMixin"],e):e(jQuery)}(function(e){e.widget("jui.jlist",e.jui.jcomponent,e.extend(!0,{},e.jui.dataMixin,{options:{autoBind:!0,delayLoad:!1,type:"normal",fields:{key:"Id",total:"Total",items:"Items"},templates:{layout:null,item:null,itemWrapper:null,edit:null,empty:null,firstAddOn:null,lastAddOn:null,tree:{subitem:null,children:null}},styleClasses:{itemSelected:"active"},cssClasses:{itemContainer:"jlist-items",item:"jlist-item",itemWrapper:"jlist-item-wrapper",itemSelected:"jlist-item-selected",itemPartSelected:"jlist-item-partselected",checkerAllChecked:"jlist-checker-all-checked",emptyItem:"jlist-empty",firstAddOn:"jlist-item-firstaddon",lastAddOn:"jlist-item-lastaddon"},selectors:{widget:".jlist",itemContainer:".jlist-items",item:".jlist-item",itemWrapper:".jlist-item-wrapper",itemSelected:".jlist-item-selected",itemPartSelected:".jlist-item-partselected",itemChecker:".jlist-item-checker",checkerAll:".jlist-checker-all",cCheckerAllChecked:".jlist-checker-all-checked",emptyItem:".jlist-empty",pager:".jlist-pager",firstAddOn:".jlist-item-firstaddon",lastAddOn:".jlist-item-lastaddon"},pageable:!1,selectable:{multiple:!1,cascade:!0,cascadeCancelParent:!0,onlyleaf:!0,selectOnClick:!0,singleSelectCanRevert:!1,checkAllElem:!1},tree:{isListData:!0,indent:16,initCollapseLevel:!1,fields:{key:"Id",children:"Children",parentKey:"ParentId"},toggleOnClick:!1,popChildren:!1,popTriggerType:"click",popAppendTo:"body",cssClasses:{children:"jlist-children",childrenItemContainer:"jlist-children-items",toggle:"jlist-item-toggle",leaf:"jlist-item-leaf",collapsed:"jlist-item-collapsed"},selectors:{children:".jlist-children",childrenItemContainer:".jlist-children-items",toggle:".jlist-item-toggle",leaf:".jlist-item-leaf"}},group:{cssClasses:{group:"jlist-group",children:"jlist-children",childrenItemContainer:"jlist-children-items"},selectors:{group:".jlist-group",children:".jlist-children",childrenItems:".jlist-children-items"},groupsFiled:"Groups",childrenField:"Children",cssClass:"jlist-group",selector:".jlist-group",templates:null},initEdit:!1,bindExtra:!1,buildItemData:e.noop,itemConverter:null,loading:{},itemClick:function(){},selected:function(){}},_$itemContainer:null,_$pager:null,_context:null,_total:0,_render:function(){function t(e){e.on("click",function(t){t.preventDefault(),t.stopPropagation(),e.hasClass(s.cssClasses.checkerAllChecked)?(i.deselectAll(),e.removeClass(s.cssClasses.checkerAllChecked)):(i.selectAll(),e.addClass(s.cssClasses.checkerAllChecked))})}var i=this,s=i.options;this.itemelems=[],this.removedItemDatas=[],this.removedItemElems=[];this.element[0].nodeName.toLowerCase();if(this.element.addClass("jlist"),this._getTemplates(),s.templates.layout&&this.element.html(s.templates.layout),this.element.is(s.selectors.itemContainer)?this._$itemContainer=this.element:(this._$itemContainer=this.element.find(s.selectors.itemContainer),this._$itemContainer.length||(this._$itemContainer=this.element.addClass(s.cssClasses.itemContainer))),this._$itemContainer.addClass(s.styleClasses.itemContainer),s.pageable){s.pageable.el?this._$pager=s.pageable.el:this._$pager=this.element.find(s.selectors.pager),this._$pager.length||(this._$pager=e("<div>").appendTo(this.element));var n=e.extend({},s.pageable,{pageChanged:function(e,t){s.pageable.pageIndex=t.pageIndex,s.pageable.pageSize=t.pageSize,i.bind()}});this._$pager.jpager(n),s.pageable=this._$pager.jpager("option")}s.selectable&&s.selectable.multiple&&(this._$checkerAll=this.element.find(s.selectors.checkerAll),this._$checkerAll.length&&t(this._$checkerAll),s.selectable.checkAllElem&&(this._$checkerAll=e(s.selectable.checkAllElem),t(e(s.selectable.checkAllElem))))},_init:function(){this.options.autoBind&&this.bind()},refresh:function(t){this.options=e.extend(!0,this.options,t),this.options.pageable&&(this.options.pageable.pageIndex=1),this.bind()},bind:function(){var t=this,i=this.options,s={};i.pageable&&(s[i.pageable.fields.pageIndex]=i.pageable.pageIndex,s[i.pageable.fields.pageSize]=i.pageable.pageSize),i.dataUrl&&i.loading&&(t.$loading&&t.$loading.close(),i.loading.appendTo=t.element,t.$loadding=e.jui.tip.loading(i.loading)),this._getData(function(){t.$loadding&&t.$loadding.close(),t.bindData(t.data)},s)},bindData:function(t){var i=this,s=this.options;t||(t=[]),i._$itemContainer.empty();var n;if(n=e.isArray(t)?t:t[s.fields.items],e.isArray(n)||(n=[]),i._total=n.length,n.length>0||this._addEmpty(),s.templates.firstAddOn){var a=e.jui.tmpl(s.templates.firstAddOn,{}),o=e(a).addClass(s.cssClasses.firstAddOn);this._$itemContainer.append(o),o.find("[data-command]").on("click",function(t){var s=e(t.currentTarget),n=s.attr("data-command");if(n)return t.preventDefault(),t.stopPropagation(),void i._trigger("itemCommand",t,{command:n})})}if("group"==s.type)for(var l=0;l<t[s.group.groupsField].length;l++){var r=t[s.group.groupsField][l];i._bindGroup(r)}else if("tree"==s.type){var u=n;s.tree.isListData&&(u=i._toTreeData(n)),s.delayLoad&&i.element.data("data",u);for(var l=0;l<u.length;l++){var d=u[l];i.bindItem(d,null,!0)}}else for(var l=0;l<n.length;l++){var d=n[l],p=!1,c=!1;0==l&&(p=!0),l==n.length-1&&(c=!0),i.bindItem(d,{index:l,first:p,last:c,items:n},!0)}if(s.pageable&&(i._total=t[s.fields.total],this._$pager.jpager("bind",{total:i._total,pageIndex:s.pageable.pageIndex})),s.templates.lastAddOn){var a=e.jui.tmpl(s.templates.lastAddOn,{}),h=e(a).addClass(s.cssClasses.lastAddOn);this._$itemContainer.append(h),h.find("[data-command]").on("click",function(t){var s=e(t.currentTarget),n=s.attr("data-command");if(n)return t.preventDefault(),t.stopPropagation(),void i._trigger("itemCommand",t,{command:n})})}i._trigger("dataBound",null,{data:t})},_getTemplates:function(){var t=this.options;this._find('script[type="text/html"]').each(function(i,s){var n=e(this),a=n.attr("data-role");if(a.indexOf(".")>0){var o=a.split(".");t.templates[o[0]][o[1]]=n.html()}else t.templates[a]=n.html()})},_bindEvents:function(t){var i=this,s=this.options,n=t.data("itemData"),a=t.find("[data-command]");if(t.is("[data-command]")&&(a=a.add(t)),a.on("click",function(s){var a=e(s.currentTarget),o=a.attr("data-command");if(o)return s.preventDefault(),s.stopPropagation(),void i._trigger("itemCommand",s,{command:o,itemData:n,itemElem:t})}),s.tree.popChildren){var o=i._getChildren(t);t.data("children",o),i.popChildrenElems||(i.popChildrenElems=[]),i.popChildrenElems.push(o),o&&t.jpop({layerElem:o,triggerType:s.tree.popTriggerType,layer:{appendTo:s.tree.popAppendTo}})}t.on("click",function(a){var o=e(a.target);if("tree"==s.type){var l=!t.is(s.tree.selectors.leaf);if(!s.tree.popChildren&&(o.is(s.tree.selectors.toggle)||l&&s.tree.toggleOnClick)){if(a.preventDefault(),a.stopPropagation(),s.delayLoad&&!t.data("isLoadedChildren")){t.data("isLoadedChildren",!0);var r=n[s.tree.fields.children];return r&&r.length&&t.toggleClass(s.tree.cssClasses.collapsed),void e.each(r,function(e,s){var n={isShowForDelayLoad:!0,relativeItem:t};i.bindItem(s,n)})}var u=i._getChildren(t);return void(null!=u&&(u.toggleClass("hide"),t.toggleClass(s.tree.cssClasses.collapsed)))}}return t.is(".jlist-item-disabled")?(a.preventDefault(),void a.stopPropagation()):s.selectable&&o.is(s.selectors.itemChecker)?(a.preventDefault(),a.stopPropagation(),void i.select(t)):(s.selectable&&s.selectable.selectOnClick&&i.select(t),void i._trigger("itemClick",a,{itemElem:t,itemData:n,inst:i}))})},_parse:function(){var t=this;t._$itemContainer.find(t.options.selectors.item).each(function(){var t={},i=e(this).attr("data-item");i&&("{"!=i.substring(0,1)&&(i="{"+i+"}"),t=new Function("return "+i)()),e(this).data("item",t)})},_createItem:function(t,i){var s=this,n=this.options;i=e.extend({level:0,isNew:!1,isEdit:!1},i),this._context&&(t.context=this._context),n.itemConverter&&e.isFunction(n.itemConverter)&&(t=n.itemConverter.call(s,t));var a=this.options.templates.item;i.isEdit&&(a=this.options.templates.edit),"tree"==n.type&&i.level>0&&n.templates.tree.subitem&&(a=n.templates.tree.subitem);var o=t;n.bindExtra&&(o=e.extend({item:t},i));var l=e.jui.tmpl(a,o),r=e(l).addClass(this.options.cssClasses.item).addClass(this.options.styleClasses.item).attr("data-item-key",t[this.options.fields.key]).data("itemData",t).attr("isnew",i.isNew).attr("isedit",i.isEdit);if("tree"==this.options.type){r.data("level",i.level);var u=r.find(".jlist-indent");u.length||(u=r),i.level>0&&this.options.tree.indent&&(n.tree.popChildren||u.css("padding-left",i.level*this.options.tree.indent)),0!=n.tree.initCollapseLevel&&n.tree.initCollapseLevel-1<=i.level&&r.addClass(n.tree.cssClasses.collapsed)}return this._trigger("itemCreated",null,{itemElem:r,itemData:t,createOptions:i}),r},bindItem:function(t,i,s){var n=this,a=n.options,o=!0;s&&(o=!1),void 0!==t&&null!=t||(t={});var l=!1;s&&a.initEdit&&(l=!0),i=e.extend({relativeItem:null,target:null,isEdit:l,position:"append"},i);var r=i.target;null==i.target&&(r=this._$itemContainer),!i.target&&i.relativeItem&&(r=i.relativeItem);var u={isNew:o,isEdit:i.isEdit,first:i.first,last:i.last,index:i.index};if("tree"==n.options.type){if("append"==i.position||"prepend"==i.position)i.relativeItem&&(r=n._getChildrenItemContainer(i.relativeItem),u.level=i.relativeItem.data("level")+1,!a.tree.popChildren&&0!=a.tree.initCollapseLevel&&a.tree.initCollapseLevel<=u.level&&!i.isShowForDelayLoad&&r.addClass("hide"),a.tree.popChildren&&r.css("display","none"));else if(a.templates.itemWrapper&&i.relativeItem&&(r=n._getItemWrapper(i.relativeItem)),i.relativeItem&&(u.level=i.relativeItem.data("level")),"after"==i.position){var d=n._getChildren(i.relativeItem);null!=d&&(r=d)}}else a.templates.itemWrapper&&i.relativeItem&&(r=n._getItemWrapper(i.relativeItem));"replace"==i.position&&(u.isNew=i.relativeItem.attr("isNew"));var p=this._createItem(t,u);if("replace"==i.position?p.data("itemInitData",i.relativeItem.data("itemInitData")):p.data("itemInitData",t),p.data("itemData",t),"tree"==n.options.type){var c=t[n.options.tree.fields.children];(!e.isArray(c)||!c.length>0)&&p.addClass(n.options.tree.cssClasses.leaf)}var h=p;if(a.templates.itemWrapper){var m=e.jui.tmpl(a.templates.itemWrapper,t),f=e(m);f.wrapInner(p).addClass(a.cssClasses.itemWrapper).addClass(a.styleClasses.itemWrapper),h=f}if("prepend"==i.position)h.prependTo(r);else if("append"==i.position){var g=r.children(a.selectors.lastAddOn);g.length?h.insertBefore(g):h.appendTo(r)}else"after"==i.position?h.insertAfter(r):"replace"==i.position&&p.replaceAll(r);if(s||"replace"==i.position||(n._total++,n.options.pageable&&n._$pager.jpager("bind",{total:n._total})),"tree"==n.options.type){var c=t[this.options.tree.fields.children];if("replace"!=i.position&&e.isArray(c)&&c.length>0){var v=e.extend(i,{relativeItem:p});a.delayLoad?a.tree.initCollapseLevel>p.data("level")+1&&(p.data("isLoadedChildren",!0),e.each(c,function(e,t){n.bindItem(t,v,s)})):e.each(c,function(e,t){n.bindItem(t,v,s)})}}return this._removeEmpty(),this._bindEvents(p),this._trigger("itemDataBound",null,{itemData:t,itemElem:p,isEdit:i.isEdit,isInit:s}),p},_createGroup:function(t){var i=e.jui.tmpl(this.options.group.template,t);return e(i).addClass(this.options.group.cssClasses.group).data("groupData",t)},_bindGroup:function(e){var t=this,i=this._createGroup(e);this._$itemContainer.append(i);var s=i.find(this.options.group.selectors.children),n=e[this.options.group.childrenField];if(n&&n.length)for(var a=0;a<n.length;a++){var o=n[a];t.bindItem(o,{target:s},!0)}},_getItemWrapper:function(e){return e.closest(this.options.selectors.itemWrapper)},_getParent:function(e){var t=e.closest(this.options.tree.selectors.children);return t&&0!=t.length?t.prev():null},_getChildren:function(e){var t=e.next();return t.is(this.options.tree.selectors.children)?t:null},_getChildrenItemContainer:function(t,i){if(t.data("children"))return t.data("children");var s=t.next();if(s.is(this.options.tree.selectors.children)||(s=e(e.jui.tmpl(this.options.templates.tree.children,{})).insertAfter(t),s.addClass(this.options.tree.cssClasses.children)),s.is(this.options.tree.selectors.childrenItemContainer))return s;var n=s.findUntil(this.options.tree.selectors.childrenItemContainer,this.options.tree.selectors.childrenItemContainer);return n.length||(n=s.addClass(this.options.tree.cssClasses.childrenItemContainer)),n},_getChildItemElems:function(e){if(e){return this._getChildrenItemContainer(e).findUntil(this.options.selectors.item,[this.options.selectors.widget,this.options.tree.selectors.children])}return this._$itemContainer.findUntil(this.options.selectors.item,[this.options.selectors.widget,this.options.tree.selectors.children])},getShortSelected:function(t,i){var s=this,n=this.options;return i=void 0!==i?i:[],this._getChildItemElems(t).each(function(t,a){e(a).is(n.selectors.itemSelected)?i.push(s.getItemData(e(a))):s.getShortSelected(e(a),i)}),i},select:function(t,i,s,n,a){var o=this,l=!1,r=i;i&&e.isPlainObject(i)||(r={notFireEvent:i,notCascade:s,notRevert:n,callback:a}),function(){o.gettingData?setTimeout(arguments.callee,200):(e.jui.utils.isJqObj(t)&&t.length>1?t.each(function(){l=o._selectSingle(e(this),r.notFireEvent,r.notCascade,r.notRevert)||l}):e.isArray(t)?e.each(t,function(e,t){l=o._selectSingle(t,r.notFireEvent,r.notCascade,r.notRevert)||l}):l=o._selectSingle(t,r.notFireEvent,r.notCascade,r.notRevert)||l,!r.notFireEvent&&l&&o._trigger("selectionChanged",null,{}),o._refreshCheckerAllState(),r.callback&&e.isFunction(r.callback)&&r.callback.call(o))}()},selectIndex:function(e,t){var i=getAllItemElems().eq(e),s=this._selectSingle(i,t.notFireEvent,t.notCascade,t.notRevert);!t.notFireEvent&&s&&this._trigger("selectionChanged",null,{})},selectAll:function(){var e=this.getAllItemElems();this.select(e,!0,!0,!0)},deselect:function(t,i){var s=this;!function(){if(s.gettingData)setTimeout(arguments.callee,200);else{var n;e.jui.utils.isJqObj(t)&&t.length>1?t.each(function(){n=s._deselectSingle(e(this),i)||n}):e.isArray(t)?e.each(t,function(e,t){n=s._deselectSingle(t,i)||n}):n=s._deselectSingle(t,i)||n,!i&&n&&s._trigger("selectionChanged",null,{}),s._refreshCheckerAllState()}}()},deselectAll:function(){var e=this.getAllItemElems();this.deselect(e,!0)},_selectItemElem:function(t,i,s,n){function a(t){var i=l._getParent(t);if(i){l._getChildren(i).removeClass("hide"),i.removeClass(r.cssClasses.itemSelected).removeClass(r.styleClasses.itemSelected).removeClass(r.cssClasses.itemPartSelected),!function(t,i){if(!t.hasClass(r.cssClasses.itemSelected))return!1;var s=!0;return l._getChildren(i).find(r.selectors.item).each(function(){if(!e(this).hasClass(r.cssClasses.itemSelected))return s=!1,!1}),s}(t,i)?!function(t,i){if(i.hasClass(r.cssClasses.itemSelected),i.hasClass(r.cssClasses.itemPartSelected))return!1;var s=!0;return l._getChildren(i).find(r.selectors.item).each(function(){if(e(this).hasClass(r.cssClasses.itemSelected)||e(this).hasClass(r.cssClasses.itemPartSelected))return s=!1,!1}),s}(t,i)?i.addClass(r.cssClasses.itemPartSelected):r.cascadeCancelParent||i.addClass(r.cssClasses.itemPartSelected):i.addClass(r.cssClasses.itemSelected).addClass(r.styleClasses.itemSelected),a(i)}}var o=!1,l=this,r=this.options;if(void 0===s&&(s=!r.selectable.cascade),!r.selectable.onlyleaf||"tree"!=r.type||t.is(r.tree.selectors.leaf)){if(!!t.hasClass(r.cssClasses.itemSelected)){if(!n){if(!r.selectable.singleSelectCanRevert&&!r.selectable.multiple)return;o=this._deselectItemElems(t)||o}}else r.selectable.multiple||this._deselectItemElems(this._getSelectedItemElems()),t.removeClass(r.cssClasses.itemPartSelected).addClass(l.options.cssClasses.itemSelected).addClass(l.options.styleClasses.itemSelected),void 0!=i&&1==i||(this._trigger("itemSelected",null,{itemElem:t,itemData:this.getItemData(t)}),o=!0);return"tree"!=r.type||s||(a(t),function(e){var t=l._getChildren(e);if(t){var i=t.findUntil(r.selectors.item,r.selectors.widget);i.removeClass(r.cssClasses.itemSelected).removeClass(r.styleClasses.itemSelected).removeClass(r.cssClasses.itemPartSelected),e.hasClass(r.cssClasses.itemSelected)&&i.addClass(r.cssClasses.itemSelected).addClass(r.styleClasses.itemSelected)}}(t)),o}},selectTo:function(t){function i(e){var t=a._getParent(e);if(t){var s=a._getChildren(t);s.hasClass("hide")&&(s.removeClass("hide"),i(t),t.removeClass(o.tree.cssClasses.collapsed))}}function s(t,i){e.each(t,function(e,t){return t[o.fields.key]==i?(r.push(t),!1):t[o.tree.fields.children]&&t[o.tree.fields.children].length&&(s(t[o.tree.fields.children],i),r.length>0)?(r.push(t),!1):void 0})}function n(e){!(e.offsetTop>a.element.scrollTop()&&e.offsetTop<a.element.scrollTop()+a.element.height())&&e.scrollIntoView&&e.scrollIntoView(!1)}var a=this,o=a.options,l=this.getItemElem(t),r=[];if(l.length){if(this._selectItemElem(l),i(l),!l.is(a.options.tree.cssClasses.leaf)){var u=a._getChildren(l);if(u)u.hasClass("hide")&&u.removeClass("hide");else if(a.options.delayLoad&&!l.data("isLoadedChildren")){l.data("isLoadedChildren",!0);var d=l.data("itemData"),p=d[o.tree.fields.children];e.each(p,function(e,t){var i={isShowForDelayLoad:!0,relativeItem:l};a.bindItem(t,i)})}l.removeClass(o.tree.cssClasses.collapsed)}n(l.get(0))}else if(a.options.delayLoad){var c=a.element.data("data");s(c,t);for(var h=r.length-1;h>=0;h--){var l=a.getItemElem(r[h][o.fields.key]);l.length||e.each(r[h+1][o.tree.fields.children],function(e,t){var i=a.getItemElem(r[h+1][o.fields.key]),s={isShowForDelayLoad:!0,relativeItem:i};a.bindItem(t,s),i.data("isLoadedChildren",!0),i.removeClass(o.tree.cssClasses.collapsed)})}r.length>0&&(l=a.getItemElem(r[0][o.fields.key]),a._selectItemElem(l),n(l.get(0)))}},_deselectItemElems:function(t,i){var s=this,n=this.options,a=!1;return t.each(function(t,o){var l=e(this);!!l.hasClass(n.cssClasses.itemSelected)&&(l.removeClass(n.cssClasses.itemSelected).removeClass(n.styleClasses.itemSelected).removeClass(n.cssClasses.itemPartSelected),void 0!=i&&1==i||(s._trigger("itemDeselected",null,{itemElem:l,itemData:s.getItemData(l)}),a=!0))}),a},_getSelectedItemElems:function(e){var t=this.options.selectors.itemSelected;return e&&(t+=","+this.options.selectors.itemPartSelected),
this.element.findUntil(t,this.options.selectors.widget)},_selectSingle:function(e,t,i,s){var n=!1,a=this.getItemElem(e);return a.length&&(n=this._selectItemElem(a,t,i,s)||n),n},_deselectSingle:function(e,t){var i=this.getItemElem(e);return this._deselectItemElems(i,t)},append:function(t,i,s){var n=this,a={position:"append",isEdit:i,relativeItem:s},o=null;return e.isArray(t)?e.each(t,function(e,t){o=n.bindItem(t,a),s&&s.removeClass(n.options.tree.cssClasses.leaf)}):(o=n.bindItem(t,a),s&&s.removeClass(n.options.tree.cssClasses.leaf)),o},prepend:function(e,t,i){var s={position:"prepend",isEdit:t,relativeItem:i};this.bindItem(e,s)},insert:function(e,t,i){this.bindItem(e,{position:"after",relativeItem:i,isEdit:t})},update:function(e,t){this.bindItem(e,{position:"replace",relativeItem:t,isEdit:!1})},remove:function(t,i){var s=this;e.isArray(t)?e.each(t,function(e,t){s._removeSingle(t,i)}):s._removeSingle(t,i)},_removeSingle:function(e){var t=this.getItemElem(e);this._removeItem(t)},_removeItem:function(e){var t=this;if(t._trigger("beforeItemRemove",null,{itemElem:e}),"true"!=e.attr("isnew")&&(this.removedItemElems.push(e),this.removedItemDatas.push(e.data("itemInitData"))),"tree"==t.options.type){var i=t._getChildren(e);i&&i.remove()}e.remove(),t._trigger("itemRemoved",null,{itemElem:e}),t._total--,t.options.pageable&&t._$pager.jpager("bind",{total:t._total}),t._addEmpty()},editItem:function(e){if(1!=e.attr("isedit")){var t=e.data("itemData");this.bindItem(t,{position:"replace",isEdit:!0,relativeItem:e}).data("inEdit",!0)}},cancelItem:function(e){if("true"==e.attr("isedit")){if(!e.data("inEdit"))return void this._removeItem(e);var t=e.data("itemData");this.bindItem(t,{position:"replace",isEdit:!1,relativeItem:e})}},saveItem:function(e){if("true"==e.attr("isedit")){var t=this.getItemData(e);return this.updateItem(e,t),t}},getItemData:function(t,i,s){return i?e.extend(!s,{},t.data("itemInitData"),this.options.buildItemData(t)):"true"==t.attr("isedit")?e.extend(!s,{},t.data("itemInitData"),this.options.buildItemData(t)):t.data("itemData")},getAll:function(){var t=this,i=this._$itemContainer.findUntil(t.options.selectors.item,t.options.selectors.widget),s=[];return i.each(function(){s.push(t.getItemData(e(this)))}),s},getSelected:function(t){var i=this,s=[];return this._getSelectedItemElems(t).each(function(){s.push(i.getItemData(e(this)))}),s},getChanges:function(t){var i=this,s=[],n=[];return this.getNewItems().each(function(){s.push(i.getItemData(e(this),void 0,t))}),this.getInitItems().each(function(){var s=e(this).data("itemInitData"),a=i.getItemData(e(this),void 0,t);e.jui.utils.jsonEqual(s,a)||n.push(a)}),{added:s,updated:n,removed:i.removedItemDatas}},getItemElem:function(t){var i,s=this;s.options;if(e.jui.utils.isJqObj(t))i=t;else{var n=t;if(e.isPlainObject(t)&&(n=t[this.options.fields.key]),i=e(s.options.selectors.item+'[data-item-key="'+n+'"]',s.element),0==i.length&&e.isArray(s.popChildrenElems))for(var a=0;a<s.popChildrenElems.length&&(i=e(s.options.selectors.item+'[data-item-key="'+n+'"]',s.popChildrenElems[a]),!(i.length>0));a++);}return i},getFirstLeaf:function(){var e=this._$itemContainer.findUntil(this.options.tree.selectors.leaf,this.options.selectors.widget).first();return{itemElem:e,itemData:e.data("itemData")}},getAllItemElems:function(){var t=this._$itemContainer.findUntil(this.options.selectors.item,this.options.selectors.widget);if(e.isArray(this.popChildrenElems))for(var i=0;i<this.popChildrenElems.length;i++)t.add(this.popChildrenElems[i].findUntil(this.options.selectors.item,this.options.selectors.widget));return t},getNewItems:function(){return this._$itemContainer.findUntil(this.options.selectors.item,this.options.selectors.widget).filter('[isnew="true"]')},getInitItems:function(){return this._$itemContainer.findUntil(this.options.selectors.item,this.options.selectors.widget).filter('[isnew="false"]')},getAllPrevItemElems:function(e){var t=this.options;if(this.options.selectors.itemWrapper){return this._getItemWrapper(e).prevAll().find(t.selectors.item)}return e.prevAll()},getAllNextItemElems:function(e){var t=this.options;if(this.options.selectors.itemWrapper){return this._getItemWrapper(e).nextAll().find(t.selectors.item)}return e.nextAll()},_toTreeData:function(t){var i,s,n=this.options,a=n.tree.fields.key,o=n.tree.fields.parentKey,l=n.tree.fields.children;if(!a||""==a||!t)return[];if(e.isArray(t)){var r=[],u=[];for(i=0,s=t.length;i<s;i++)u[t[i][a]]=t[i];for(i=0,s=t.length;i<s;i++)u[t[i][o]]&&t[i][a]!=t[i][o]?(u[t[i][o]][l]||(u[t[i][o]][l]=[]),u[t[i][o]][l].push(t[i])):r.push(t[i]);return r}return[t]},_addEmpty:function(){var t=this.options;t.templates.empty&&(this._total>0||e(e.jui.tmpl(t.templates.empty,{})).appendTo(this._$itemContainer).addClass(t.cssClasses.emptyItem))},_removeEmpty:function(){var e=this.options;this._$itemContainer.find(e.selectors.emptyItem).remove()},_refreshCheckerAllState:function(){if(void 0!==this._$checkerAll){var e=this.getAllItemElems();this._getSelectedItemElems().length==e.length?this._$checkerAll.addClass(this.options.cssClasses.checkerAllChecked):this._$checkerAll.removeClass(this.options.cssClasses.checkerAllChecked)}},disableItem:function(e){this.getItemElem(e).addClass("jlist-item-disabled")},enableItem:function(e){this.getItemElem(e).removeClass("jlist-item-disabled")},disable:function(){this.getAllItemElems().each(function(t,i){e(this).addClass("jlist-item-disabled")})},enable:function(){this.getAllItemElems().each(function(t,i){e(this).removeClass("jlist-item-disabled")})}}))}),function(e){"function"==typeof define&&define.amd?define("jui/lists/jlistMenu",["jquery","./jlist"],e):e(jQuery)}(function(e){e.widget("jui.jlistMenu",e.jui.jlist,{options:{templates:{itemWrapper:"<li></li>",tree:{children:"<ul></ul>"}},mode:"v",fields:{key:"id",text:"text",icon:"icon",url:"url"},cssClasses:{menu:"jlistMenu",menuv:"menu",menuh:"menu-row"},selectable:{multiple:!1,cascade:!0,onlyleaf:!1,selectOnClick:!1},tree:{isListData:!1,indent:30,initCollapseLevel:!1,fields:{children:"children",parentKey:"pid"},toggleOnClick:!0},itemConverter:function(e){return e.text=e[this.options.fields.text],e.key=e[this.options.fields.key],e}},_render:function(){var t=this.options;"tree"==t.type?"h"==t.mode?(t.templates.item=t.templates.item||'<a class="{{if disabled}}jlist-item-disabled{{/if}}" href="{{if url}}{{url}}{{else}}javascript:void(0);{{/if}}"><span>{{if icon}}<i class="{{icon}}"></i> {{/if}}{{text}}</span> {{if !notoggle}}<span class="jlist-item-toggle"></span>{{/if}}</a>',this.options=t=e.extend(!0,{},t,{templates:{tree:{children:'<ul class="box popbox menu tight"></ul>'}},tree:{initCollapseLevel:1,popChildren:!0,popTriggerType:"click",popAppendTo:"body"}})):t.templates.item=t.templates.item||'<a class="hcard {{if disabled}}jlist-item-disabled{{/if}}" href="{{if url}}{{url}}{{else}}javascript:void(0);{{/if}}">{{if icon}}<span class="hcard-hd"><i class="{{icon}}"></i></span>{{/if}}<span class="hcard-bd">{{text}}</span>{{if !notoggle}}<span class="hcard-ft"><span class="jlist-item-toggle"></span></span>{{/if}}</a>':t.templates.item=t.templates.item||'<a class="{{if disabled}}jlist-item-disabled{{/if}}" href="{{if url}}{{url}}{{else}}javascript:void(0);{{/if}}"><span>{{if icon}}<i class="{{icon}}"></i>{{/if}}{{text}}</span></a>',"h"==t.mode?this.element.addClass(t.cssClasses.menuh):"v"==t.mode&&this.element.addClass(t.cssClasses.menuv),this.element.bind("jlistmenuitemcreated",function(e,t){t.itemData.disabled&&t.itemElem.addClass("ui-state-disabled")}),this._super()}})}),function(e){"function"==typeof define&&define.amd?define("jui/lists/jlistTabs",["jquery","./jlistMenu"],e):e(jQuery)}(function(e){e.widget("jui.jlistTabs",e.jui.jlistMenu,{options:{mode:"h",styleClass:"jlistMenu-line",activeKey:null},_render:function(){var t=this,i=this.options;this.element.addClass("jlistTabs"),this._super();var s=this.widgetEventPrefix.toLowerCase();this.element.bind(s+"itemdeselected",function(t,s){var n=s.itemData;e("#"+n[i.fields.key]).addClass("hide")}),this.element.bind(s+"itemselected",function(t,s){var n=s.itemData,a=e("#"+n[i.fields.key]);if(n.route){var o=a.data("router");if(o)0==n.cache&&o.refresh();else{var l=n.route;e.isPlainObject(l)||(l={url:n.route}),o=a.jrouter(l).jrouter("instance"),a.data("router",o)}}a.removeClass("hide")}),i.activeKey&&this.element.bind(s+"itemdatabound",function(e,s){t.select(i.activeKey)})}})}),function(e){"function"==typeof define&&define.amd?define("jui/lists/jlistSteps",["jquery","./jlistTabs"],e):e(jQuery)}(function(e){e.widget("jui.jlistSteps",e.jui.jlistTabs,{options:{mode:"h",styleClass:"jlistMenu-line",activeKey:null},_render:function(){var e=this;this.options;this.element.addClass("jlistSteps"),this._super();var t=this.widgetEventPrefix.toLowerCase();this.element.bind(t+"itemselected",function(t,i){var s=i.itemElem,n=e.getAllItemElems(),a=e.getAllPrevItemElems(s);n.removeClass("jlistSteps-success"),a.addClass("jlistSteps-success")})}})}),function(e){"function"==typeof define&&define.amd?define("jui/lists/jlistGrid",["jquery","jqueryui","./jlist","../utils","../misc/jpager"],e):e(jQuery)}(function(e){e.widget("jui.jlistGrid",e.jui.jlist,{options:{templates:{colgroup:null,thead:null},height:null,tableStyle:null},_create:function(){var t=this,i=this.options;this.element.addClass("jlist-grid"),this.$header=e("<div>").addClass("jlist-grid-header").appendTo(this.element),this.$body=e("<div>").addClass("jlist-grid-body").appendTo(this.element),this.$footer=e("<div>").addClass("jlist-grid-footer").appendTo(this.element),this.$headerTable=e('<table class="table"></table>').appendTo(this.$header),this.$bodyTable=e("<table></table>").appendTo(this.$body).addClass("table");var s=e.jui.tmpl(i.templates.colgroup,{}),n=(e(s).appendTo(this.$headerTable),e.jui.tmpl(i.templates.thead,{}));e(n).appendTo(this.$headerTable);e(s).appendTo(this.$bodyTable),e('<tbody class="jlist-items")></tbody>').appendTo(this.$bodyTable),i.templates.footer&&e(e.jui.tmpl(i.templates.footer,{})).appendTo(this.$footer),i.tableStyle&&(this.$headerTable.addClass(i.tableStyle),this.$bodyTable.addClass(i.tableStyle)),i.pageable&&0==this.$footer.find(i.selectors.pager).length&&e('<div class="jlist-pager"></div>').appendTo(this.$footer),i.height&&(t._setBodyHeight(i.height),t.element.bind("jlistgriddatabound",function(){t._setBodyHeight(i.height)}),e(window).on("resize",function(){t._setBodyHeight(i.height)})),t._scrollBody(),this._super()},_setBodyHeight:function(t){var i=this.element.parent();if("fit"==t){var s=parseFloat(i.css("margin-top"));s||(s=0);var n=parseFloat(i.css("margin-bottom"));n||(n=0),t=e(window).height()-i.offset().top-s-n}t<100&&(t=100),i.outerHeight(t),this.element.outerHeight(i.height());var a=this.$header.outerHeight(!0),o=this.$footer.outerHeight(!0),l=this.element.height()-a-o;this.$body.innerHeight(l,!0)},_scrollBody:function(){var e=this;this.$body.on("scroll",function(){var t=e.$body.scrollLeft();e.$headerTable.css("left",-t)})}})}),function(e){"function"==typeof define&&define.amd?define("jui/lists/jlistCommands",["jquery","jqueryui","./jlist"],e):e(jQuery)}(function(e){e.widget("jui.jlistCommands",e.jui.jlist,{options:{fields:{key:"id",text:"text",icon:"icon",url:"url"},type:"tree",target:null,mode:"button",templates:{itemWrapper:"<li></li>",tree:{children:'<ul class="box popbox menu tight"></ul>'}},selectable:{multiple:!1,cascade:!1,cascadeCancelParent:!0,onlyleaf:!1,selectOnClick:!1,singleSelectCanRevert:!1,checkAllElem:!1},tree:{initCollapseLevel:1,popChildren:!0,popTriggerType:"click",popAppendTo:"body",isListData:!1,fields:{children:"children",parentKey:"pid"},toggleOnClick:!0},itemClick:function(t,i){t.preventDefault(),t.stopPropagation();var s=i.itemData;s.command&&e.isFunction(s.command)&&s.command.call(i.inst,i.inst.options.target)}},_render:function(){var e=this.options;this.element.addClass("jlistCommands"),"button"==e.mode?(this.element.addClass("list-inline"),e.styleClass=e.styleClass||"space tighter",this.element.addClass(e.styleClass),e.templates.item=e.templates.item||'<button class="btn {{styleClass}} {{if disabled}}jlist-item-disabled{{/if}}"{{if disabled}} disabled="disabled"{{/if}}>{{if icon}}<i class="{{icon}}"></i>{{/if}} {{text}} {{if !notoggle}}<span class="jlist-item-toggle"></span>{{/if}}</button>',e.templates.tree.subitem=e.templates.tree.subitem||'<a class="{{if disabled}}jlist-item-disabled{{/if}}" href="{{if url}}{{url}}{{else}}javascript:void(0);{{/if}}">                        <span>{{if icon}}<i class="{{icon}}"></i> {{/if}}{{text}}</span>                    {{if !notoggle}}<span class="jlist-item-toggle"></span>{{/if}}</a>'):"menu-row"==e.mode&&(this.element.addClass("menu-row"),e.styleClass=e.styleClass||"tight",this.element.addClass(e.styleClass),e.templates.item=e.templates.item||'<a class="{{styleClass}}{{if disabled}} jlist-item-disabled{{/if}}"{{if onlyIcon}} title="{{text}}"{{/if}}>{{if icon}}<i class="{{icon}}"></i>{{/if}}{{if !onlyIcon}} {{text}}{{/if}}</a>'),this._super()}})}),function(e){"function"==typeof define&&define.amd?define("jui/lists/jlistWithCommands",["jquery","./jlist","./jlistMenu","./jlistCommands"],e):e(jQuery)}(function(e){var t={_jlistCreate:e.jui.jlist.prototype._render,_jlistMenuCreate:e.jui.jlistMenu.prototype._render},i=function(e){return{options:{commands:null},_render:function(){var t=this.options;t.commands&&this.element.bind((this.widgetEventPrefix+"itemDataBound").toLowerCase(),function(e,i){var s=i.itemElem,n=(i.itemData,s.find(".commands"));t.commands.target=i,n.jlistCommands(t.commands)}),e.apply(this,arguments)}}};e.extend(!0,e.jui.jlist.prototype,i(t._jlistCreate)),e.extend(!0,e.jui.jlistMenu.prototype,i(t._jlistMenuCreate))}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jinput",["jquery","jqueryui","../jcomponent","../mixins/dataMixin","../layers/jlayer","../utils"],e):e(jQuery)}(function(e){e.widget("jui.jinput",e.jui.jcomponent,e.extend(!0,{},e.jui.dataMixin,{options:{isInput:!0,hasValue:!0,label:!1,labelAlign:"right",labelClass:null,wrapperClass:null,required:!1,requiredMessage:"必填",viewMode:!0,asyncSetInitValue:!1,invalidTipAlign:"top right",ruleTypes:{number:{validator:function(e){return/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},message:"请输入有效的数字"},digits:{validator:function(e){return/^\d+$/.test(e)},message:"只能输入数字"},regex:{validator:function(e,t){return new RegExp(t.pattern,t.attributes).test(e)}},email:{validator:function(e){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(e)},message:"请输入有效的 Email 地址"},url:{validator:function(e){return/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},message:"请输入有效的 URL"},min:{validator:function(e,t){return(e=Number(e))>=t},message:"输入值不能小于 {0}"},max:{validator:function(e,t){return(e=Number(e))<=t},message:"输入值不能大于 {0}"},range:{validator:function(e,t){return(e=Number(e))>=t[0]&&e<=t[1]},message:"输入值必须介于 {0} 和 {1} 之间"},minlength:{validator:function(t,i){return(e.isArray(t)?t.length:e.trim(t).length)>=i},message:"不能少于 {0} 个字"},maxlength:{validator:function(t,i){return(e.isArray(t)?t.length:e.trim(t).length)<=i},message:"不能多于 {0} 个字"},rangelength:{validator:function(t,i){var s=0;return s=e.isArray(t)?t.length:e.trim(t).length,i[0]<=s&&s<=i[1]},message:"输入字数在 {0} 个到 {1} 个之间"},remote:{validator:function(t,i){var s={};return s[i[1]]=t,"true"==e.ajax({url:i[0],dataType:"json",data:s,async:!1,cache:!1,type:"post"}).responseText},message:"Please fix this field"},date:{validator:function(t,i){var s=this.options.dateFormat;i&&i.length>0&&(s=i[0]);var n=!1;try{e.datepicker.parseDate(s,t),n=!0}catch(e){n=!1}return n},message:"请输入有效的日期格式."},identifier:{validator:function(e,t){return/^[a-zA-Z][a-zA-Z0-9_]*$/.test(e)},message:"只能输入字母、数字、下划线且必须以字母开头"},phoneNumber:{validator:function(e,t){return/^1[3|4|5|7|8][0-9]{9}$/.test(e)},message:"请输入正确的手机号"}},rules:[]},_render:function(){var t=this,i=this.options;i.labelAlign||(i.labelAlign="right"),i.labelClass||(i.labelClass="col-sm-2"),i.wrapperClass||(i.wrapperClass="col-sm-10"),this.element.addClass("jinput"),t._getData(function(){if(t.__beforeRender(),i.isGroup||(this.$children=this.element.children().remove()),1==i.showLabel||i.label&&0!=i.showLabel){if(this.element.addClass("form-group").addClass("label-"+i.labelAlign),this.$controlLabel=e('<label class="control-label"></label>').html(i.label).appendTo(this.element),this.$controlWrapper=e('<div class="control-wrapper"></div>').appendTo(this.element),this.$inputWrapper=e('<div class="input-wrapper"></div>').appendTo(this.$controlWrapper),i.required){var s="right"==i.labelAlign?"prepend":"append";this.$controlLabel[s]('<span class="required" aria-required="true"> * </span>')}"top"!=i.labelAlign&&(i.labelClass&&this.$controlLabel.addClass(i.labelClass),i.wrapperClass&&this.$controlWrapper.addClass(i.wrapperClass))}else i.isGroup||(this.$inputWrapper=e('<div class="input-wrapper"></div>').appendTo(this.element));i.isGroup||this.$children&&this.$children.length>0&&this.$children.appendTo(this.$inputWrapper),null!=i.inputWrapperStyleClass&&t.$inputWrapper.addClass(i.inputWrapperStyleClass),null!=i.inputWrapperStyle&&t.$inputWrapper.css(i.inputWrapperStyle),e.isFunction(t._inputRender)&&t._inputRender(),i.asyncSetInitValue||i.transmitData||this.setValue(this.data,!0),this.validateTriggered=!1,this.errorMessage="",this._on(this.widget(),{focusin:function(e){t.invalidTip&&t.invalidTip.show()},focusout:function(e){t.invalidTip&&t.invalidTip.hide()},mouseenter:function(e){t.invalidTip&&t.invalidTip.show()},mouseleave:function(i){t.invalidTip&&(i.target===t.document[0].activeElement||e.contains(i.target,t.document[0].activeElement)||t.invalidTip.hide())}}),t.__afterRender()})},_getValue:e.noop,_setValue:e.noop,_parseValue:e.noop,getValue:function(){return this._getValue()},setValue:function(t,i){void 0===t||e.isPlainObject(t)&&e.isEmptyObject(t)||this._setValue(t,i),i&&(this.initValue=this.getValue(),this.getValueText?this.initValueText=this.getValueText():this.initValueText=null,this.currentValue=this.initValue)},focus:function(){this.widget().focus()},validate:function(){if(1==this.isDisabled())return!0;this.validateTriggered=!0;var t=this._validate();return t?this.element.removeClass("jinput-invalid"):this.element.addClass("jinput-invalid"),t?this.invalidTip&&(this.invalidTip.close(),this.invalidTip=null):(this.invalidTip?this.invalidTip.message(this.errorMessage):this.invalidTip=e.jui.tip.warning({message:this.errorMessage,appendTo:this.element,follow:this.$inputWrapper,align:this.options.invalidTipAlign,attachElem:this.element,autoShow:!1,showClose:!1,style:{margin:0},styleClass:"val-tip"}),(this.element.is(":hover")||this.$inputWrapper.is(":focus"))&&this.invalidTip.show()),t},getInvalids:function(){return this.invalid},_validate:function(){var t=this.options;this.setMessage("");var i=this._getRawValue?this._getRawValue():this.getValue(),s=void 0!=i&&null!=i&&""!=i;if(t.required&&(void 0===i||null===i||""===i||e.isArray(i)&&i.length<1))return this.setMessage(t.requiredMessage),!1;if(s&&t.rules&&e.isArray(t.rules))for(var n=0;n<t.rules.length;n++)if(!this._checkRule(t.rules[n],i))return!1;return!0},_checkRule:function(t,i){var s=this,n=this.options,a=null;if(t.type?a=n.ruleTypes[t.type]:t.validator&&(a=t),a){var o=t.param||null;if(!a.validator.call(s,i,o)){var l=t.message||a.message;if(o){e.isArray(o)||(o=[o]);for(var r=0;r<o.length;r++)l=l.replace(new RegExp("\\{"+r+"\\}","g"),o[r])}return this.setMessage(n.invalidMessage||l),!1}}return!0},setMessage:function(e){this.errorMessage=e},onValueChanged:function(){var e=this.currentValue;this.currentValue=this.getValue(),this._trigger("valueChanged",null,{oldValue:e,newValue:this.currentValue,inst:this}),this.parent&&this.parent.onValueChanged&&this.parent.onValueChanged(),this.validateTriggered&&this.validate()},getChanged:function(t){if(void 0!=this.options.trackChange&&0==this.options.trackChange)return!1;var i=this.getValue(),s={widget:this.widgetName,name:this.name,label:this.options.label,field:this.name,fieldName:this.options.label,newValue:i};return this.getValueText&&(s.newValueText=this.getValueText()),t?!!i&&(s.oldValue=null,s.oldValueText=null,s):!e.jui.utils.jsonEqual(i,this.initValue)&&(s.oldValue=this.initValue,s.oldValueText=this.initValueText,s)}}))}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jtextbox",["jquery","jqueryui","./jinput"],e):e(jQuery)}(function(e){e.widget("jui.jtextbox",e.jui.jinput,{options:{inputType:"text",iconClass:null,iconAlign:"left",placeHolder:null,button:null,suffix:null},_inputRender:function(){var t=this,i=this.options;if(this.element.addClass("jtextbox"),i.iconClass&&(this.$icon=e("<i></i>").addClass(i.iconClass).appendTo(this.$inputWrapper),this.element.addClass("with-icon").addClass("icon-"+i.iconAlign)),this.$input=e('<input class="form-control" />').appendTo(this.$inputWrapper),this.$input.attr("type",i.inputType),i.placeHolder&&this.$input.attr("placeholder",i.placeHolder),"password"==i.inputType?this.$input.attr("autocomplete","new-password"):this.$input.attr("autocomplete","off"),i.disabled&&this.disable(),this._on(this.$input,{focus:function(){t.validating=!0,t.value=t._getRawValue(),function(){t.validating&&(t.value!=t._getRawValue()&&(t.value=t._getRawValue(),t.onValueChanged()),setTimeout(arguments.callee,200))}()},blur:function(){t.validating=!1,t._trigger("blur",null,{inst:t})}}),i.button){i.button=e.extend({type:"button",align:"after"},i.button),this.$inputWrapper.addClass("input-group"),this.$button=e('<button class="btn"></button>').addClass(i.button.styleClass).attr("type",i.button.type).text(i.button.text);var s=e('<span class="input-group-btn"></span>').append(this.$button);"before"==i.button.align?s.prependTo(this.$inputWrapper):s.appendTo(this.$inputWrapper),this._on(this.$button,{click:function(){i.button.click.call(t)}})}i.suffix&&(this.$inputWrapper.addClass("input-group"),this.$suffix=e('<span class="input-group-addon"></span>').html(i.suffix).appendTo(this.$inputWrapper))},getValue:function(){return this.$input.val()},_getRawValue:function(){return this.$input.val()},_setValue:function(e,t){this.currentValue=this.$input.val(),this.$input.val(e),t||e!=this.currentValue&&this.onValueChanged()},focus:function(){this.$input.focus()},_setOption:function(e,t){"disabled"===e&&this.$input.prop("disabled",!!t),this._super(e,t)}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jtextarea",["jquery","jqueryui","./jinput"],e):e(jQuery)}(function(e){e.widget("jui.jtextarea",e.jui.jinput,{options:{placeHolder:null,rows:3},_inputRender:function(){var t=this,i=this.options;this.element.addClass("jtextarea"),this.$input=e('<textarea class="form-control"></textarea>').appendTo(this.$inputWrapper),i.placeHolder&&this.$input.attr("placeholder",i.placeHolder),i.rows&&this.$input.attr("rows",i.rows),this.$input.attr("autocomplete","off"),i.disabled&&this.disable(),this._on(this.$input,{focus:function(){t.validating=!0,t.value=t._getRawValue(),function(){t.validating&&(t.value!=t._getRawValue()&&(t.value=t._getRawValue(),t.onValueChanged()),setTimeout(arguments.callee,200))}()},blur:function(){t.validating=!1}})},getValue:function(){return this.$input.val()},_getRawValue:function(){return this.$input.val()},_setValue:function(e){this.$input.val(e)},focus:function(){this.$input.focus()},_setOption:function(e,t){"disabled"===e&&this.$input.prop("disabled",!!t),this._super(e,t)}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jnumberbox",["jquery","jqueryui","./jtextbox"],e):e(jQuery)}(function(e){e.widget("jui.jnumberbox",e.jui.jtextbox,{options:{min:null,max:null,precision:0,decimalSeparator:".",groupSeparator:"",prefix:"",suffix:""},_inputRender:function(){var t=this,i=[];this.element.addClass("jnumberbox"),0==this.options.precision&&i.push({type:"regex",param:{pattern:"^(\\-|\\+)?(0|[1-9][0-9]*)$"},message:"请输入整数"}),this.options.precision>0&&i.push({type:"regex",param:{pattern:"^(\\-|\\+)?(0|[1-9][0-9]*)(\\.\\d{"+this.options.precision+"})$"},message:"请输入 "+this.options.precision+" 位小数"}),this.options.min&&i.push({type:"min",param:this.options.min}),this.options.max&&i.push({type:"max",param:this.options.max}),this.options=e.extend(!0,{},this.options,{rules:i}),this._super(),this.$input.on("blur",function(){t._trigger("blur",null,{inst:t})})},getValue:function(){var e=this.$input.val();return e=parseFloat(e).toFixed(this.options.precision),isNaN(e)&&(e=null),e}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jcheckbox",["jquery","jqueryui","./jinput"],e):e(jQuery)}(function(e){e.widget("jui.jcheckbox",e.jui.jinput,{options:{labelFollow:!1},_beforeCreate:function(){this.options.labelFollow&&(this.options.showLabel=!1)},_inputRender:function(){this.element.addClass("jcheckbox"),this.$label=e("<label></label>").appendTo(this.$inputWrapper),this.$input=e('<input type="checkbox" />').appendTo(this.$label),this.options.labelFollow&&this.$label.append(this.options.label),this.options.disabled&&this.disable()},getValue:function(){return this.$input.prop("checked")},_setValue:function(e){this.$input.prop("checked",e)},disable:function(){this.$input.prop("disabled",!0),this.options.disabled=!0},enable:function(){this.$input.prop("disabled",!1),this.options.disabled=!1},focus:function(){this.$input.focus()},_setOption:function(e,t){"disabled"===e&&this.$input.prop("disabled",!!t)}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jradiolist",["jquery","jqueryui","../utils","../lists/jlist","../forms/jinput"],e):e(jQuery)}(function(e){e.widget("jui.jradiolist",e.jui.jinput,{options:{fields:{text:"text",value:"value"},sourceList:{fields:{key:"value"}},mode:null},_inputRender:function(){var t=this,i=this.options;this.element.addClass("jradiolist");var s='<ul class="jlist-items"></ul>',n='<li><label><input type="radio" value="{{value}}"> {{text}}</label></li>';"button"==i.mode&&(s='<div class="btn-group jlist-items" role="group">',n='<button class="btn">{{text}}</button>'),i.sourceList=e.extend(!0,{styleClasses:{itemContainer:"list-inline tight"},fields:{key:i.fields.value},templates:{layout:s,item:n}},i.sourceList,{itemConverter:function(e){return t._itemConverter(e)},itemSelected:function(e,i){t._renderSelected(i.itemData)},selectionChanged:function(){t.onValueChanged()}}),this.$inputWrapper.jlist(this.options.sourceList)},refresh:function(e){this.$inputWrapper.jlist("bind",e)},_renderSelected:function(t){function i(e){e=s._itemConverter(e),s.$inputWrapper.find("input").val([e.value])}var s=this;this.options;if(!t)return void this.$inputWrapper.find("input").prop("checked",!1);e.isArray(t)?e.each(t,function(e,t){i(t)}):i(t)},getSelected:function(){return this.$inputWrapper.jlist("getSelected")},getValue:function(){var e=this.options,t=this.getSelected();return t.length?t[0][e.fields.value]:null},getValueText:function(){var e=this.options,t=this.getSelected();return t.length?t[0][e.fields.text]:null},_setValue:function(t,i){var s=this;if(!t)return this.$inputWrapper.jlist("deselectAll"),void this._renderSelected(null);this.$inputWrapper.jlist("select",t,{notFireEvent:i,callback:function(){i&&(e.isPlainObject(t)||(t=s.$inputWrapper.jlist("getSelected")),s._renderSelected(t))}})},_itemConverter:function(e){var t=this.options.fields;return!("text"in e)&&(e.text=e[t.text]),!("value"in e)&&(e.value=e[t.value]),e},disable:function(){this.$inputWrapper.jlist("disable"),this.$inputWrapper.find("input").prop("disabled",!0),this.options.disabled=!0},enable:function(){this.$inputWrapper.jlist("enable"),this.$inputWrapper.find("input").prop("disabled",!1),this.options.disabled=!1}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jcheckboxlist",["jquery","jqueryui","../utils","../lists/jlist","./jinput"],e):e(jQuery)}(function(e){e.widget("jui.jcheckboxlist",e.jui.jinput,{options:{fields:{text:"text",value:"value"},sourceList:{styleClasses:{itemContainer:"list-inline tight"},selectable:{multiple:!0,onlyleaf:!1,cascade:!0},tree:{indent:20,fields:{children:"children",parentKey:"pid"},valueIncludePart:!0},method:"GET",templates:{layout:'<ul class="jlist-items list tight"></ul>',tree:{children:'<ul class="list tight"></ul>'}}}},_inputRender:function(){var t=this,i=this.options;this.element.addClass("jcheckboxlist");var s=i.sourceList.templates.item||'<li><input type="checkbox" value="{{value}}"> <label>{{text}}</label></li>';"tree"==i.sourceList.type&&(i.sourceList.styleClasses={itemContainer:"tight"}),i.sourceList=e.extend(!0,{},i.sourceList,{fields:{key:i.fields.value},templates:{item:s},selectable:{cascadeCancelParent:!1},itemConverter:function(e){return t._itemConverter(e)},itemSelected:function(e,i){t._renderSelected(i.itemData)},itemDeselected:function(e,t){t.itemElem.find("input").prop("checked",!1)},selectionChanged:function(){t.onValueChanged()}}),this.cascade=i.sourceList.selectable.cascade,this.$inputWrapper.jlist(this.options.sourceList),this.sourceList=this.$inputWrapper.jlist("instance")},refresh:function(e){this.$inputWrapper.jlist("bind",e)},_renderSelected:function(t){function i(e){e=s._itemConverter(e),s.$inputWrapper.find('input[value="'+e.value+'"]').prop("checked",!0)}var s=this;this.options;if(void 0===t||null==t||""==t)return void this.$inputWrapper.find("input").prop("checked",!1);e.isArray(t)?e.each(t,function(e,t){i(t)}):i(t)},_deselect:function(e){this.options;this.options.multiple&&this.$multipleDisplay.jlist("remove",e)},getSelected:function(){var e="tree"==this.sourceList.options.type&&1==this.sourceList.options.tree.valueIncludePart;return this.sourceList.getSelected(e)},getValue:function(){var t=this.options,i=this.getSelected();return e.map(i,function(e,i){return e[t.fields.value]})},getValueText:function(){var t=this.options,i=this.getSelected();return e.map(i,function(e,i){return e[t.fields.text]}).toString()},_setValue:function(t,i){var s=this
;if(!t)return this.$inputWrapper.jlist("deselectAll"),void this._renderSelected(null);i&&this.$inputWrapper.jlist("option","selectable.cascade",!1),this.$inputWrapper.jlist("select",t,{notFireEvent:i,callback:function(){i&&(s.$inputWrapper.jlist("option","selectable.cascade",s.cascade),e.isPlainObject(t)||(t=s.$inputWrapper.jlist("getSelected")),s._renderSelected(t))}})},_itemConverter:function(e){var t=this.options.fields;return!("text"in e)&&(e.text=e[t.text]),!("value"in e)&&(e.value=e[t.value]),e},disable:function(){this.$inputWrapper.jlist("disable"),this.$inputWrapper.find("input").prop("disabled",!0),this.options.disabled=!0},enable:function(){this.$inputWrapper.jlist("enable"),this.$inputWrapper.find("input").prop("disabled",!1),this.options.disabled=!1}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jselect",["jquery","jqueryui","../utils","../lists/jlist","./jinput"],e):e(jQuery)}(function(e){e.widget("jui.jselect",e.jui.jinput,{options:{fields:{text:"text",value:"value",filter:"q"},value:null,styleClass:"jselect-default",emptyData:null,sourceList:{method:"GET",templates:{itemWrapper:"<li></li>",item:'<a href="javascript:;">{{text}}</a>'},styleClasses:{itemContainer:"menu active-highlight"}},selectedList:{templates:{item:"<li>{{text}}</li>"}},singleTemplate:"{{text}}",multiple:!1,showArrow:!0,pop:{trigger:null,layer:{fitElem:".jselect-list",size:{maxHeight:"fit"}}},searchPlaceholder:"",remoteSearch:!1,autocomplete:!0,minItemsForSearch:20,filterConverter:null,delay:300},_inputRender:function(){var t=this,i=this.options;this.element.addClass("jselect"),this.$selectInput=e('<select class="jselect-select"><option value=""></option></select>').appendTo(this.$inputWrapper),this.$wrapper=this.$inputWrapper,this.$display=e('<div class="jselect-display"></div>').appendTo(this.$wrapper),i.multiple?(this.$selectInput.attr("multiple","multiple"),this.$multipleDisplay=e('<div class="jselect-display-multiple"><ul class="jlist-items"></ul></div>').appendTo(this.$display),i.selectedList=e.extend({},{fields:{key:i.fields.value}},i.selectedList),this.$multipleDisplay.jlist(i.selectedList)):this.$singleDisplay=e('<div class="jselect-display-single"></div>').appendTo(this.$display),i.showArrow&&(this.$displayArrow=e('<span class="jselect-display-arrow"><i class="fa fa-angle-down"></i></span>').appendTo(this.$display)),this.$popLayer=e('<div class="jselect-pop"><div class="jselect-search"></div><div class="jselect-list"><ul class="jlist-items"></ul></div></div>').appendTo(this.$wrapper),this.$sourceList=this.$popLayer.find(".jselect-list"),this.$search=this.$popLayer.find(".jselect-search");var s={placeholder:i.searchPlaceholder};i.pageable&&(this.$pager=e("<div></div>").addClass("jselect-pager").insertAfter(this.$sourceList)),i.autocomplete||(s.button={text:"search"}),this.popMinWidth=t.$display.outerWidth(),this.$pop=this.$display,this.options.disabled&&this.disable();var n=e.extend(!0,{},i.pop,{layerElem:t.$popLayer,layer:{size:{maxHeight:"fit",width:Math.max(220,t.popMinWidth)}},disabled:i.disabled});if(i.remoteSearch&&t.$search.show(),this.$pop.jpop(n),i.autocomplete?s.valueChanged=function(e,i){t._search(i.newValue)}:s.button.click=function(){t._search(this.getValue())},this.$search.jtextbox(s),i.sourceList=e.extend(!0,{},{fields:{key:i.fields.value}},i.sourceList,{selectable:{multiple:i.multiple},pageable:!!i.pageable&&e.extend(!0,i.pageable,{el:this.$pager,displayItemCount:0,edgeItemCount:0,texts:{info:" "}}),dataBound:function(s,n){t.$popLayer.jlayer("setSize"),t.$popLayer.jlayer("setPosition");var a=n.data;i.emptyData&&t.$sourceList.jlist("prepend",i.emptyData).jlist("select",i.emptyData);var o;e.isArray(a)?o=a:a&&(o=a[e(this).jlist("option").fields.items]),e.isArray(o)||(o=[]),i.remoteSearch||(-1!=i.minItemsForSearch&&o.length>i.minItemsForSearch?t.$search.show():t.$search.hide()),t._renderOptions(o),i.pageable&&i.multiple&&e.each(t.$multipleDisplay.jlist("getAll"),function(e,i){t.$sourceList.jlist("select",i,!0)})},itemSelected:function(e,s){t._renderSelected(s.itemData),t._setSelectInputValue(),i.multiple||t.$pop.jpop("hide"),t._trigger("select",e,s)},itemDeselected:function(e,i){t._deselect(i.itemData),t._setSelectInputValue(),t._trigger("deselect",e,i)},selectionChanged:function(){t.onValueChanged()},itemConverter:function(e){return t._itemConverter(e)}}),"tree"==i.sourceList.type){var a={cssClasses:{styleClass:"jlist-tree"}};i.sourceList=e.extend({},i.sourceList,a)}this.$sourceList.jlist(i.sourceList)},_itemConverter:function(e){var t=this.options.fields;return!("text"in e)&&(e.text=e[t.text]),!("value"in e)&&(e.value=e[t.value]),e},_renderSelected:function(t){function i(t){t=s._itemConverter(t),n.multiple?s.$multipleDisplay.jlist("append",t):(s.$singleDisplay.html(e.jui.tmpl(n.singleTemplate,t)).attr("title",t.text),s.$singleDisplay.data("itemData",t))}var s=this,n=this.options;if(!t)return void(n.multiple?s.$multipleDisplay.jlist("bind",null):(s.$singleDisplay.html(""),s.$singleDisplay.data("itemData",t)));e.isArray(t)?e.each(t,function(e,t){i(t)}):i(t)},_renderOptions:function(t){e.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++){var s=t[i],n=s[this.options.fields.text];"string"!==e.type(n)&&(n=JSON.stringify(n));var a=s[this.options.fields.value];"string"!==e.type(a)&&(a=JSON.stringify(a));var o=e('<option value="'+a+'"></option>');o.text(n),this.$selectInput.append(o)}},_deselect:function(e){this.options.multiple&&this.$multipleDisplay.jlist("remove",e)},deselect:function(e){this.options.remoteSearch?(this._deselect(e),this._setSelectInputValue(),this._trigger("deselect",null,{itemData:e})):this.$sourceList.jlist("deselect",e)},getSelected:function(){if(this.options.multiple)return this.$multipleDisplay.jlist("getAll");var e=this.$singleDisplay.data("itemData");return e?[e]:[]},_setValue:function(t,i){var s=this;if(void 0===t||null==t)return this.$sourceList.jlist("deselectAll"),void this._renderSelected(null);this.options.remoteSearch?(this._renderOptions(t),this._renderSelected(t),this._setSelectInputValue()):this.$sourceList.jlist("select",t,{notFireEvent:i,callback:function(){i&&(e.isPlainObject(t)||(t=s.$sourceList.jlist("getSelected")),s._renderSelected(t),s._setSelectInputValue())}})},getValue:function(){var t=this,i=this.options,s=t.getSelected(),n=e.map(s,function(e,t){return e[i.fields.value]});return n.length?i.multiple?n:n[0]:null},getValueText:function(){var t=this,i=this.options,s=t.getSelected(),n=e.map(s,function(e,t){return e[i.fields.text]});return n.length?i.multiple?n.toString():n[0]:null},_setSelectInputValue:function(){var e=this.getValue();this.$selectInput.val(e)},_searchTimeout:function(e){clearTimeout(this.searching),this.searching=this._delay(function(){var t={};t[this.options.fields.filter]=e,this.$sourceList.jlist("bind",{filter:t})},this.options.delay)},_search:function(t){var i=this;if(this.options.remoteSearch)this._searchTimeout(t);else{var s=new RegExp(t,"i");this.$sourceList.jlist("getAllItemElems").each(function(t,n){var a=i.$sourceList.jlist("getItemData",e(n));s.test(a.text)?e(n).show():e(n).hide()})}},getSourceList:function(){return this.$sourceList},widget:function(){return this.$wrapper},_setOption:function(e,t){"disabled"===e&&this.$display.toggleClass("ui-state-disabled",!!t),this._super(e,t)}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jdatepicker",["jquery","jqueryui","./jtextbox"],e):e(jQuery)}(function(e){e.widget("jui.jdatepicker",e.jui.jtextbox,{options:{inputType:"text",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"c-100:c+50"},_inputRender:function(){var t=this,i=this.options;this._super(),this.element.addClass("jdatepicker"),this.$inputWrapper.addClass("input-group"),this.$icon=e('<div class="input-group-addon"><i class="fa fa-calendar" /></div>').appendTo(this.$inputWrapper),i.onSelect=function(){t.onValueChanged()},i.onClose=function(){try{var s=e.datepicker.parseDate(i.dateFormat,t.$input.val());t.$input.val(e.datepicker.formatDate(i.dateFormat,s))}catch(s){t.$input.val(e.datepicker.formatDate(i.dateFormat,t.$input.datepicker("getDate")))}t._trigger("closed",null,null)},this.$input.datepicker(i),this._on(this.$icon,{click:function(e){e&&e.preventDefault?e.preventDefault():e.returnValue=!1,this.$input.attr("disabled","disabled"),this.$input.datepicker("show"),this.$input.removeAttr("disabled")}})},getValue:function(){return this.$input.val()},_setValue:function(e){this.$input.datepicker("setDate",e)},openPicker:function(){this.$input.datepicker("show")}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jinputgroup",["jquery","jqueryui","./jinput","../mixins/compositMixin"],e):e(jQuery)}(function(e){e.widget("jui.jinputgroup",e.jui.jinput,e.extend(!0,{},e.jui.compositMixin,{options:{transmitData:!0,flatData:!1,isGroup:!0},_beforeCreate:function(){this.options.label=null},_inputRender:function(){this._renderChildren()},_getValue:function(){if(this.components&&this.components.length){for(var t={},i=0;i<this.components.length;i++){var s=this.components[i],n=this["$"+s.name];n&&(n.options.isInput&&(n.options.flatData?e.extend(t,n.getValue()):t[s.name]=n.getValue()))}return t}},_setValue:function(e,t){var i=this;this.options;if(i.components&&i.components.length)for(var s=0;s<i.components.length;s++){var n=i.components[s],a=i["$"+n.name];if(a&&a.options.isInput){var o=a.options;e.hasOwnProperty(o.name)&&(o.flatData?a.setValue(e,t):a.setValue(e[o.name],t))}}},validate:function(){for(var e=this.invalid=[],t=0;t<this.components.length;t++){var i=this.components[t],s=this["$"+i.name];s&&(s.options.isInput&&(s.isHidden()||s.validate()||e.push(s)))}return e.length>0&&e[0].focus(),0==e.length},getChild:function(e){return this["$"+e]},getInvalids:function(){return this.invalid},getChanged:function(e){for(var t=[],i=0;i<this.components.length;i++){var s=this.components[i],n=this["$"+s.name];if(n&&(!n.isHidden()&&n.options.isInput)){var a=n.getChanged(e);a&&t.push(a)}}return t},disable:function(){for(var t=0;t<this.components.length;t++){var i=this.components[t],s=this["$"+i.name];s&&(e.isFunction(s.disable)&&s.disable())}},enable:function(){for(var t=0;t<this.components.length;t++){var i=this.components[t],s=this["$"+i.name];s&&(e.isFunction(s.enable)&&s.enable())}}}))}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jinputrepeat",["jquery","jqueryui","./jinput","./jinputgroup","../utils"],e):e(jQuery)}(function(e){e.widget("jui.jinputrepeat",e.jui.jinput,{options:{itemComponents:[],getDataMode:"getChanges",layoutMode:"table",keyField:"Id"},_inputRender:function(){var t=this,i=this.options;this.removeItemData=[];var s=i.templates&&i.templates.layout||"",n=i.templates&&i.templates.item||"",a=i.templates&&i.templates.edit||"";if("table"==i.layoutMode){s='<table class="jlist-table table table-bordered"><thead><tr>',n="<tr>";for(var o=0;o<i.itemComponents.length;o++){var l=i.itemComponents[o];s+="<td>"+l.label+"</td>",n+=e.jui.utils.format('<td><div name="{0}"></div></td>',l.name),l.showLabel=!1}s+="<td></td>",n+='<td><button class="btn btn-xs" data-command="remove"><i class="fa fa-close"></i></button></td>',s+='</tr></thead><tbody class="jlist-items"></tbody></table>',n+="</tr>",s+='<button class="btn" type="button" data-role="AddBtn">添加</button>',a=n}else if("flow"==i.layoutMode){s='<div class="jlist-items"></div><div><button class="btn" type="button" data-role="AddBtn">添加</button></div>',n='<div class="m-y-md b-b">';for(var o=0;o<i.itemComponents.length;o++){var l=i.itemComponents[o];n+=e.jui.utils.format('<div name="{0}"></div>',l.name)}n+="</div>",a=n}this.list=this.$inputWrapper.jlist({initEdit:!0,templates:{layout:s,item:n,edit:a},itemDataBound:function(s,n){var a=n.itemElem,o=e.extend(!0,[],i.itemComponents);a.jinputgroup({components:o,data:n.itemData,isRepeatInit:n.isInit}).jinputgroup("instance").parent=t},beforeItemRemove:function(e,s){for(var n={},a=s.itemElem,o=a.jinputgroup("instance"),l=0;l<i.itemComponents.length;l++){var r=i.itemComponents[l],u=o["$"+r.name];u.getValueText?n[r.name]=u.getValueText():n[r.name]=u.getValue()}t.removeItemData.push(n)},buildItemData:function(e){return e.jinputgroup("getValue")},itemCommand:function(i,s){"remove"==s.command&&(e(this).jlist("remove",s.itemElem),t.onValueChanged())}}).jlist("instance"),this._on(this._find('[data-role="AddBtn"]'),{click:function(){t.$inputWrapper.jlist("append",{},!0),t.onValueChanged()}})},validate:function(){for(var t=[],i=this.$inputWrapper.jlist("getAllItemElems"),s=0;s<i.length;s++){var n=i[s];e(n).jinputgroup("validate")||t.push(e(n).jinputgroup("getInvalids"))}return 0==t.length},getValue:function(){return"getChanges"==this.options.getDataMode?this.$inputWrapper.jlist("getChanges"):this.$inputWrapper.jlist("getAll")},_setValue:function(e,t){this.$inputWrapper.jlist("bindData",e)},getChanged:function(){var t=this.options,i={widget:this.widgetName,name:this.name,label:t.label,added:[],updated:[],removed:this.removeItemData},s=this.list.getNewItems();if(s.length>0)for(var n=0;n<s.length;n++){var a=e(s[n]),o={id:null};o.changed=a.jinputgroup("getChanged",!0),i.added.push(o)}var l=this.list.getInitItems();if(l.length>0)for(var n=0;n<l.length;n++){var r=e(l[n]),u=r.jinputgroup("getChanged");if(u.length>0){var d=this.list.getItemData(r),p={};p.key=d[t.keyField],p.changed=u,i.updated.push(p)}}return(i.added.length>0||i.updated.length>0||i.removed.length>0)&&i}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jtagbox",["jquery","./jinput"],e):e(jQuery)}(function(e){e.widget("jui.jtagbox",e.jui.jinput,{options:{},_changeToContent:function(t){var i=this,s=e("<span>×</span>").css({color:"#999",cursor:"pointer",display:"inline-block","font-weight":"bold","margin-right":"2px"}).on("click",function(){e(this).parent().remove(),i.onValueChanged()});e("<li>").text(t).prepend(s).insertBefore(this.$inputArea).css({"list-style":"none",padding:0,margin:0,float:"left","background-color":"#e4e4e4",border:"1px solid #aaa","border-radius":"4px",cursor:"default","margin-right":"5px","margin-top":"5px",padding:"0 5px"}).addClass("inputContent")},_getValue:function(){var t=[];return this.$inputList.find(".inputContent").each(function(){var i=e(this),s=i.text(),n=s.substr(1,s.length-1);t.push(n)}),t.length>0?t:null},_bindEvents:function(){var t=this;this._on(this.$container,{click:function(e){t.$inputList.last().find("input").focus()},focusin:function(e){},focusout:function(e){}}),this._on(this.$input,{input:t.inputEvent=function(t){var i=e(t.target);i.css("width",(1*i.val().length>1?1*i.val().length:1)+"em")},keydown:t.keydownEvent=function(i){if(13==i.keyCode){var s=e(i.target);t._changeToContent(s.val());var n=this.$baseInput.clone();s.replaceWith(n),t._on(n,{input:t.inputEvent,keydown:t.keydownEvent}),n.focus(),t.onValueChanged()}else if(8==i.keyCode){var s=e(i.target);if(""===s.val()){i.preventDefault();var a=s.parent().prev().text();s.parent().prev().remove(),s.val(a.substr(1,a.length-1)),s.css("width",(1*s.val().length>1?1*s.val().length:1)+"em"),t.onValueChanged()}}}})},_domConstructor:function(){this.$container=e("<span>").css({width:"100%","border-radius":"4px",display:"block",padding:0}).addClass("form-control").appendTo(this.$inputWrapper),this.$inputList=e("<ul>").addClass("inputList").appendTo(this.$container).css({"list-style":"none",padding:0,margin:0,display:"inline-block",width:"100%",padding:"0 0 0 5px"}),this.$input=e("<input>").css({background:"transparent",border:"none",outline:0,"box-shadow":"none","-webkit-appearance":"textfield",width:"1.5em"}),this.$baseInput=this.$input.clone(),this.$inputArea=e("<li>").append(this.$input).appendTo(this.$inputList).css({"list-style":"none",float:"left","padding-top":"6px"})},_setValue:function(t){t&&t.length>0&&e.each(t,e.proxy(function(e,t){this._changeToContent(t)},this))},focus:function(){this.$inputList.children().last().find("input").focus()},_inputRender:function(){this._domConstructor(),this._bindEvents()}})}),function(e){"function"==typeof define&&define.amd?define("jui/forms/jformCommands",["jquery","jqueryui","./jinput","../lists/jlistCommands"],e):e(jQuery)}(function(e){e.widget("jui.jformCommands",e.jui.jinput,{options:{isInput:!1,commands:{}},_inputRender:function(){var e=this.options;this.$inputWrapper.jlistCommands(e.commands)}})}),function(){"function"==typeof define&&define(["jui/utils","jui/mixins/compositMixin","jui/mixins/dataMixin","jui/mixins/templateMixin","jui/jcomponent","jui/jtmpl","jui/misc/jpager","jui/misc/jcollapse","jui/layers/jlayer","jui/layers/jpop","jui/layers/jlayer.modal","jui/layers/jlayer.alert","jui/layers/jlayer.tip","jui/utils.ajax","jui/spa","jui/lists/jlist","jui/lists/jlistMenu","jui/lists/jlistTabs","jui/lists/jlistSteps","jui/lists/jlistGrid","jui/lists/jlistCommands","jui/lists/jlistWithCommands","jui/forms/jinput","jui/forms/jtextbox","jui/forms/jtextarea","jui/forms/jnumberbox","jui/forms/jcheckbox","jui/forms/jradiolist","jui/forms/jcheckboxlist","jui/forms/jselect","jui/forms/jdatepicker","jui/forms/jinputrepeat","jui/forms/jinputgroup","jui/forms/jtagbox","jui/forms/jformCommands"])}();